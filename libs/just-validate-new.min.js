var _=Object.defineProperty,w=Object.getOwnPropertySymbols,X=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable,E=(e,i,s)=>i in e?_(e,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[i]=s,L=(e,i)=>{for(var s in i||(i={}))X.call(i,s)&&E(e,s,i[s]);if(w)for(var s of w(i))Z.call(i,s)&&E(e,s,i[s]);return e},u=(e,i,s)=>(E(e,"symbol"!=typeof i?i+"":i,s),s);!function(e,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(e="undefined"!=typeof globalThis?globalThis:e||self).JustValidate=i()}(this,(function(){"use strict";const e=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,i=/^[0-9]+$/,s=/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$/,t=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;var l,r,o,a;(r=l||(l={})).Required="required",r.Email="email",r.MinLength="minLength",r.MaxLength="maxLength",r.Password="password",r.Number="number",r.MaxNumber="maxNumber",r.MinNumber="minNumber",r.StrongPassword="strongPassword",r.CustomRegexp="customRegexp",r.MinFilesCount="minFilesCount",r.MaxFilesCount="maxFilesCount",r.Files="files",function(e){e.Required="required"}(o||(o={})),function(e){e.Label="label",e.LabelArrow="labelArrow"}(a||(a={}));const n=e=>!!e&&"function"==typeof e.then,d={errorFieldStyle:{color:"#b81111",border:"1px solid #B81111"},errorFieldCssClass:"just-validate-error-field",successFieldCssClass:"just-validate-success-field",errorLabelStyle:{color:"#b81111"},errorLabelCssClass:"just-validate-error-label",successLabelCssClass:"just-validate-success-label",focusInvalidField:!0,lockForm:!0,testingMode:!1};return class{constructor(e,i,s){u(this,"form",null),u(this,"fields",{}),u(this,"groupFields",{}),u(this,"errors",{}),u(this,"isValid",!1),u(this,"isSubmitted",!1),u(this,"globalConfig",d),u(this,"errorLabels",[]),u(this,"successLabels",[]),u(this,"eventListeners",[]),u(this,"dictLocale",[]),u(this,"currentLocale"),u(this,"customStyleTags",{}),u(this,"onSuccessCallback"),u(this,"onFailCallback"),u(this,"tooltips",[]),u(this,"lastScrollPosition"),u(this,"isScrollTick"),u(this,"refreshAllTooltips",(()=>{this.tooltips.forEach((e=>{e.refresh()}))})),u(this,"handleDocumentScroll",(()=>{this.lastScrollPosition=window.scrollY,this.isScrollTick||(window.requestAnimationFrame((()=>{this.refreshAllTooltips(),this.isScrollTick=!1})),this.isScrollTick=!0)})),u(this,"formSubmitHandler",(e=>{e.preventDefault(),this.isSubmitted=!0,this.globalConfig.lockForm&&this.lockForm(),this.validate().finally((()=>{var i,s;this.globalConfig.lockForm&&this.unlockForm(),this.isValid?null==(i=this.onSuccessCallback)||i.call(this,e):null==(s=this.onFailCallback)||s.call(this,this.fields)}))})),u(this,"handleFieldChange",(e=>{let i,s;for(const t in this.fields){const l=this.fields[t];if(l.elem===e){i=l,s=t;break}}!i||!s||this.validateField(s,i,!0)})),u(this,"handleGroupChange",(e=>{let i,s;for(const t in this.groupFields){const l=this.groupFields[t];if(l.elems.find((i=>i===e))){i=l,s=t;break}}!i||!s||this.validateGroup(s,i)})),u(this,"handlerChange",(e=>{!e.target||(this.handleFieldChange(e.target),this.handleGroupChange(e.target),this.renderErrors())})),this.initialize(e,i,s)}initialize(e,i,s){if(this.form=null,this.errors={},this.isValid=!1,this.isSubmitted=!1,this.globalConfig=d,this.errorLabels=[],this.eventListeners=[],this.customStyleTags={},this.tooltips=[],"string"==typeof e){const i=document.querySelector(e);if(!i)throw Error(`Form with ${e} selector not found! Please check the form selector`);this.setForm(i)}else{if(!(e instanceof HTMLFormElement))throw Error("Form selector is not valid. Please specify a string selector or a DOM element.");this.setForm(e)}if(this.globalConfig=L(L({},d),i),s&&(this.dictLocale=s),this.isTooltip()){const e=document.createElement("style");e.textContent=".just-validate-error-label[data-tooltip=true]{position:fixed;padding:4px 8px;background:#423f3f;color:#fff;white-space:nowrap;z-index:10;border-radius:4px;transform:translateY(-5px)}.just-validate-error-label[data-tooltip=true]:before{content:'';width:0;height:0;border-left:solid 5px transparent;border-right:solid 5px transparent;border-bottom:solid 5px #423f3f;position:absolute;z-index:3;display:block;bottom:-5px;transform:rotate(180deg);left:calc(50% - 5px)}.just-validate-error-label[data-tooltip=true][data-direction=left]{transform:translateX(-5px)}.just-validate-error-label[data-tooltip=true][data-direction=left]:before{right:-7px;bottom:auto;left:auto;top:calc(50% - 2px);transform:rotate(90deg)}.just-validate-error-label[data-tooltip=true][data-direction=right]{transform:translateX(5px)}.just-validate-error-label[data-tooltip=true][data-direction=right]:before{right:auto;bottom:auto;left:-7px;top:calc(50% - 2px);transform:rotate(-90deg)}.just-validate-error-label[data-tooltip=true][data-direction=bottom]{transform:translateY(5px)}.just-validate-error-label[data-tooltip=true][data-direction=bottom]:before{right:auto;bottom:auto;left:calc(50% - 5px);top:-5px;transform:rotate(0)}",this.customStyleTags[a.Label]=document.head.appendChild(e),this.addListener("scroll",document,this.handleDocumentScroll)}}getLocalisedString(e){var i;return this.currentLocale&&this.dictLocale.length&&(null==(i=this.dictLocale.find((i=>i.key===e)))?void 0:i.dict[this.currentLocale])||e}getFieldErrorMessage(e,i){const s="function"==typeof e.errorMessage?e.errorMessage(this.getElemValue(i),this.fields):e.errorMessage;return this.getLocalisedString(s)||((e,i)=>{switch(e){case l.Required:return"The field is required";case l.Email:return"Email has invalid format";case l.MaxLength:return"The field must contain a maximum of :value characters".replace(":value",String(i));case l.MinLength:return"The field must contain a minimum of :value characters".replace(":value",String(i));case l.Password:return"Password must contain minimum eight characters, at least one letter and one number";case l.Number:return"Value should be a number";case l.StrongPassword:return"Password should contain minimum eight characters, at least one uppercase letter, one lowercase letter, one number and one special character";case l.MaxNumber:return"Number should be less or equal than :value".replace(":value",String(i));case l.MinNumber:return"Number should be more or equal than :value".replace(":value",String(i));case l.MinFilesCount:return"Files count should be more or equal than :value".replace(":value",String(i));case l.MaxFilesCount:return"Files count should be less or equal than :value".replace(":value",String(i));case l.Files:return"Uploaded files have one or several invalid properties (extension/size/type etc)";default:return"Value is incorrect"}})(e.rule,e.value)}getFieldSuccessMessage(e,i){const s="function"==typeof e?e(this.getElemValue(i),this.fields):e;return this.getLocalisedString(s)}getGroupErrorMessage(e){return this.getLocalisedString(e.errorMessage)||(e=>e===o.Required?"The field is required":"Group is incorrect")(e.rule)}getGroupSuccessMessage(e){return this.getLocalisedString(e.successMessage)}setFieldInvalid(e,i){this.fields[e].isValid=!1,this.fields[e].errorMessage=this.getFieldErrorMessage(i,this.fields[e].elem)}setFieldValid(e,i){this.fields[e].isValid=!0,void 0!==i&&(this.fields[e].successMessage=this.getFieldSuccessMessage(i,this.fields[e].elem))}setGroupInvalid(e,i){this.groupFields[e].isValid=!1,this.groupFields[e].errorMessage=this.getGroupErrorMessage(i)}setGroupValid(e,i){this.groupFields[e].isValid=!0,this.groupFields[e].successMessage=this.getGroupSuccessMessage(i)}getElemValue(e){switch(e.type){case"checkbox":return e.checked;case"file":return e.files;default:return e.value}}validateGroupRule(e,i,s,t){if(t.rule===o.Required)("radio"===i||"checkbox"===i)&&(s.every((e=>!e.checked))?this.setGroupInvalid(e,t):this.setGroupValid(e,t))}validateFieldRule(r,o,a,d=!1){const u=a.value,c=this.getElemValue(o);if(a.plugin)a.plugin(c,this.fields)||this.setFieldInvalid(r,a);else switch(a.rule){case l.Required:(e=>{let i=e;return"string"==typeof e&&(i=e.trim()),!i})(c)&&this.setFieldInvalid(r,a);break;case l.Email:if("string"!=typeof c){this.setFieldInvalid(r,a);break}(i=>e.test(i))(c)||this.setFieldInvalid(r,a);break;case l.MaxLength:if(void 0===u){console.error(`Value for ${a.rule} rule for [${r}] field is not defined. The field will be always invalid.`),this.setFieldInvalid(r,a);break}if("number"!=typeof u){console.error(`Value for ${a.rule} rule for [${r}] should be a number. The field will be always invalid.`),this.setFieldInvalid(r,a);break}if("string"!=typeof c){this.setFieldInvalid(r,a);break}if(""===c)break;((e,i)=>e.length>i)(c,u)&&this.setFieldInvalid(r,a);break;case l.MinLength:if(void 0===u){console.error(`Value for ${a.rule} rule for [${r}] field is not defined. The field will be always invalid.`),this.setFieldInvalid(r,a);break}if("number"!=typeof u){console.error(`Value for ${a.rule} rule for [${r}] should be a number. The field will be always invalid.`),this.setFieldInvalid(r,a);break}if("string"!=typeof c){this.setFieldInvalid(r,a);break}if(""===c)break;((e,i)=>e.length<i)(c,u)&&this.setFieldInvalid(r,a);break;case l.Password:if("string"!=typeof c){this.setFieldInvalid(r,a);break}if(""===c)break;(e=>s.test(e))(c)||this.setFieldInvalid(r,a);break;case l.StrongPassword:if("string"!=typeof c){this.setFieldInvalid(r,a);break}if(""===c)break;(e=>t.test(e))(c)||this.setFieldInvalid(r,a);break;case l.Number:if("string"!=typeof c){this.setFieldInvalid(r,a);break}if(""===c)break;(e=>i.test(e))(c)||this.setFieldInvalid(r,a);break;case l.MaxNumber:{if(void 0===u){console.error(`Value for ${a.rule} rule for [${r}] field is not defined. The field will be always invalid.`),this.setFieldInvalid(r,a);break}if("number"!=typeof u){console.error(`Value for ${a.rule} rule for [${r}] field should be a number. The field will be always invalid.`),this.setFieldInvalid(r,a);break}if("string"!=typeof c){this.setFieldInvalid(r,a);break}if(""===c)break;const e=+c;(Number.isNaN(e)||((e,i)=>e>i)(e,u))&&this.setFieldInvalid(r,a);break}case l.MinNumber:{if(void 0===u){console.error(`Value for ${a.rule} rule for [${r}] field is not defined. The field will be always invalid.`),this.setFieldInvalid(r,a);break}if("number"!=typeof u){console.error(`Value for ${a.rule} rule for [${r}] field should be a number. The field will be always invalid.`),this.setFieldInvalid(r,a);break}if("string"!=typeof c){this.setFieldInvalid(r,a);break}if(""===c)break;const e=+c;(Number.isNaN(e)||((e,i)=>e<i)(e,u))&&this.setFieldInvalid(r,a);break}case l.CustomRegexp:{if(void 0===u)return console.error(`Value for ${a.rule} rule for [${r}] field is not defined. This field will be always invalid.`),void this.setFieldInvalid(r,a);let e;try{e=new RegExp(u)}catch{console.error(`Value for ${a.rule} rule for [${r}] should be a valid regexp. This field will be always invalid.`),this.setFieldInvalid(r,a);break}const i=String(c);""!==i&&!e.test(i)&&this.setFieldInvalid(r,a);break}case l.MinFilesCount:if(void 0===u){console.error(`Value for ${a.rule} rule for [${r}] field is not defined. This field will be always invalid.`),this.setFieldInvalid(r,a);break}if("number"!=typeof u){console.error(`Value for ${a.rule} rule for [${r}] field should be a number. The field will be always invalid.`),this.setFieldInvalid(r,a);break}if(Number.isFinite(null==c?void 0:c.length)&&c.length<u){this.setFieldInvalid(r,a);break}break;case l.MaxFilesCount:if(void 0===u){console.error(`Value for ${a.rule} rule for [${r}] field is not defined. This field will be always invalid.`),this.setFieldInvalid(r,a);break}if("number"!=typeof u){console.error(`Value for ${a.rule} rule for [${r}] field should be a number. The field will be always invalid.`),this.setFieldInvalid(r,a);break}if(Number.isFinite(null==c?void 0:c.length)&&c.length>u){this.setFieldInvalid(r,a);break}break;case l.Files:{if(void 0===u)return console.error(`Value for ${a.rule} rule for [${r}] field is not defined. This field will be always invalid.`),void this.setFieldInvalid(r,a);if("object"!=typeof u)return console.error(`Value for ${a.rule} rule for [${r}] field should be an object. This field will be always invalid.`),void this.setFieldInvalid(r,a);const e=u.files;if("object"!=typeof e)return console.error(`Value for ${a.rule} rule for [${r}] field should be an object with files array. This field will be always invalid.`),void this.setFieldInvalid(r,a);const i=(e,i)=>{const s=Number.isFinite(i.minSize)&&e.size<i.minSize,t=Number.isFinite(i.maxSize)&&e.size>i.maxSize,l=Array.isArray(i.names)&&!i.names.includes(e.name),r=Array.isArray(i.extensions)&&!i.extensions.includes(e.name.split(".")[e.name.split(".").length-1]),o=Array.isArray(i.types)&&!i.types.includes(e.type);return s||t||l||r||o};if("object"==typeof c&&null!==c)for(let s=0,t=c.length;s<t;++s){const t=c.item(s);if(!t){this.setFieldInvalid(r,a);break}if(i(t,e)){this.setFieldInvalid(r,a);break}}break}default:{if("function"!=typeof a.validator)return console.error(`Validator for custom rule for [${r}] field should be a function. This field will be always invalid.`),void this.setFieldInvalid(r,a);const e=a.validator(c,this.fields);if("boolean"!=typeof e&&"function"!=typeof e&&console.error(`Validator return value for [${r}] field should be boolean or function. It will be cast to boolean.`),"function"==typeof e){if(!d){this.fields[r].asyncCheckPending=!1;const i=e();return n(i)?i.then((e=>{e||this.setFieldInvalid(r,a)})).catch((()=>{this.setFieldInvalid(r,a)})):(console.error(`Validator function for custom rule for [${r}] field should return a Promise. This field will be always invalid.`),void this.setFieldInvalid(r,a))}this.fields[r].asyncCheckPending=!0}e||this.setFieldInvalid(r,a)}}}validateField(e,i,s=!1){var t;i.isValid=!0;const l=[];return[...i.rules].reverse().forEach((t=>{const r=this.validateFieldRule(e,i.elem,t,s);n(r)&&l.push(r)})),i.isValid&&this.setFieldValid(e,null==(t=i.config)?void 0:t.successMessage),Promise.allSettled(l)}validateGroup(e,i){const s=[];return[...i.rules].reverse().forEach((t=>{const l=this.validateGroupRule(e,i.type,i.elems,t);n(l)&&s.push(l)})),Promise.allSettled(s)}focusInvalidField(){for(const e in this.fields){const i=this.fields[e];if(!i.isValid){setTimeout((()=>i.elem.focus()),0);break}}}afterSubmitValidation(){this.renderErrors(),this.globalConfig.focusInvalidField&&this.focusInvalidField()}validate(){return new Promise((e=>{const i=[];Object.keys(this.fields).forEach((e=>{const s=this.fields[e],t=this.validateField(e,s);n(t)&&i.push(t)})),Object.keys(this.groupFields).forEach((e=>{const s=this.groupFields[e],t=this.validateGroup(e,s);n(t)&&i.push(t)})),i.length?Promise.allSettled(i).then((()=>{this.afterSubmitValidation(),e(!0)})):(this.afterSubmitValidation(),e(!1))}))}setForm(e){this.form=e,this.form.setAttribute("novalidate","novalidate"),this.removeListener("submit",this.form,this.formSubmitHandler),this.addListener("submit",this.form,this.formSubmitHandler)}addListener(e,i,s){i.addEventListener(e,s),this.eventListeners.push({type:e,elem:i,func:s})}removeListener(e,i,s){i.removeEventListener(e,s),this.eventListeners=this.eventListeners.filter((s=>s.type!==e||s.elem!==i))}addField(e,i,s){if("string"!=typeof e)throw Error("Field selector is not valid. Please specify a string selector.");const t=document.querySelector(e);if(!t)throw Error(`Field with ${e} selector not found! Please check the field selector.`);if(!Array.isArray(i)||!i.length)throw Error(`Rules argument for the field [${e}] should be an array and should contain at least 1 element.`);return i.forEach((i=>{if(!("rule"in i||"validator"in i||"plugin"in i))throw Error(`Rules argument for the field [${e}] must contain at least one rule or validator property.`);if(!(i.validator||i.plugin||i.rule&&Object.values(l).includes(i.rule)))throw Error(`Rule should be one of these types: ${Object.values(l).join(", ")}. Provided value: ${i.rule}`)})),this.fields[e]={elem:t,rules:i,isValid:void 0,config:s},this.setListeners(t),this.isSubmitted&&this.validate(),this}removeField(e){if("string"!=typeof e)throw Error("Field selector is not valid. Please specify a string selector.");if(!this.fields[e])return console.error("Field not found. Check the field selector."),this;const i=this.getListenerType(this.fields[e].elem.type);return this.removeListener(i,this.fields[e].elem,this.handlerChange),this.clearErrors(),delete this.fields[e],this}removeGroup(e){if("string"!=typeof e)throw Error("Group selector is not valid. Please specify a string selector.");return this.groupFields[e]?(this.groupFields[e].elems.forEach((e=>{const i=this.getListenerType(e.type);this.removeListener(i,e,this.handlerChange)})),this.clearErrors(),delete this.groupFields[e],this):(console.error("Group not found. Check the group selector."),this)}addRequiredGroup(e,i,s,t){if("string"!=typeof e)throw Error("Group selector is not valid. Please specify a string selector.");const l=document.querySelector(e);if(!l)throw Error(`Group with ${e} selector not found! Please check the group selector.`);const r=l.querySelectorAll("input"),a=Array.from(r).every((e=>"radio"===e.type)),n=Array.from(r).every((e=>"checkbox"===e.type));if(!a&&!n)throw Error("Group should contain either or checkboxes or radio buttons");return this.groupFields[e]={rules:[{rule:o.Required,errorMessage:i,successMessage:t}],groupElem:l,elems:Array.from(r),type:a?"radio":"checkbox",isDirty:!1,isValid:void 0,config:s},r.forEach((e=>{this.setListeners(e)})),this}getListenerType(e){switch(e){case"checkbox":case"select-one":case"file":case"radio":return"change";case"date":return"input";default:return"keyup"}}setListeners(e){const i=this.getListenerType(e.type);this.removeListener(i,e,this.handlerChange),this.addListener(i,e,this.handlerChange)}clearErrors(){var e,i,s,t,l,r;this.errorLabels.forEach((e=>e.remove())),this.successLabels.forEach((e=>e.remove()));for(const l in this.fields){const r=this.fields[l],o=(null==(e=r.config)?void 0:e.errorFieldStyle)||this.globalConfig.errorFieldStyle;Object.keys(o).forEach((e=>{r.elem.style[e]=""}));const a=(null==(i=r.config)?void 0:i.successFieldStyle)||this.globalConfig.successFieldStyle||{};Object.keys(a).forEach((e=>{r.elem.style[e]=""})),r.elem.classList.remove((null==(s=r.config)?void 0:s.errorFieldCssClass)||this.globalConfig.errorFieldCssClass,(null==(t=r.config)?void 0:t.successFieldCssClass)||this.globalConfig.successFieldCssClass)}for(const e in this.groupFields){const i=this.groupFields[e],s=(null==(l=i.config)?void 0:l.errorFieldStyle)||this.globalConfig.errorFieldStyle;Object.keys(s).forEach((e=>{i.elems.forEach((s=>{var t;s.style[e]="",s.classList.remove((null==(t=i.config)?void 0:t.errorFieldCssClass)||this.globalConfig.errorFieldCssClass)}))}));const t=(null==(r=i.config)?void 0:r.successFieldStyle)||this.globalConfig.successFieldStyle||{};Object.keys(t).forEach((e=>{i.elems.forEach((s=>{var t;s.style[e]="",s.classList.remove((null==(t=i.config)?void 0:t.successFieldCssClass)||this.globalConfig.successFieldCssClass)}))}))}this.tooltips=[]}isTooltip(){return!!this.globalConfig.tooltip}lockForm(){const e=this.form.querySelectorAll("input, textarea, button, select");for(let i=0,s=e.length;i<s;++i)e[i].setAttribute("disabled","disabled"),e[i].style.pointerEvents="none",e[i].style.webkitFilter="grayscale(100%)",e[i].style.filter="grayscale(100%)"}unlockForm(){const e=this.form.querySelectorAll("input, textarea, button, select");for(let i=0,s=e.length;i<s;++i)e[i].removeAttribute("disabled"),e[i].style.pointerEvents="",e[i].style.webkitFilter="",e[i].style.filter=""}renderTooltip(e,i,s){var t;const{top:l,left:r,width:o,height:a}=e.getBoundingClientRect(),n=i.getBoundingClientRect(),d=s||(null==(t=this.globalConfig.tooltip)?void 0:t.position);switch(d){case"left":i.style.top=l+a/2-n.height/2+"px",i.style.left=r-n.width-5+"px";break;case"top":i.style.top=l-n.height-5+"px",i.style.left=r+o/2-n.width/2+"px";break;case"right":i.style.top=l+a/2-n.height/2+"px",i.style.left=`${r+o+5}px`;break;case"bottom":i.style.top=`${l+a+5}px`,i.style.left=r+o/2-n.width/2+"px"}return i.dataset.direction=d,{refresh:()=>{this.renderTooltip(e,i,s)}}}createErrorLabelElem(e,i,s){const t=document.createElement("div");t.innerHTML=i;const l=this.isTooltip()?null==s?void 0:s.errorLabelStyle:(null==s?void 0:s.errorLabelStyle)||this.globalConfig.errorLabelStyle;return Object.assign(t.style,l),t.classList.add((null==s?void 0:s.errorLabelCssClass)||this.globalConfig.errorLabelCssClass,"just-validate-error-label"),this.isTooltip()&&(t.dataset.tooltip="true"),this.globalConfig.testingMode&&(t.dataset.testId=`error-label-${e}`),this.errorLabels.push(t),t}createSuccessLabelElem(e,i,s){if(void 0===i)return null;const t=document.createElement("div");t.innerHTML=i;const l=(null==s?void 0:s.successLabelStyle)||this.globalConfig.successLabelStyle;return Object.assign(t.style,l),t.classList.add((null==s?void 0:s.successLabelCssClass)||this.globalConfig.successLabelCssClass,"just-validate-success-label"),this.globalConfig.testingMode&&(t.dataset.testId=`success-label-${e}`),this.successLabels.push(t),t}renderFieldLabel(e,i){var s,t,l,r,o,a,n;if("checkbox"===e.type||"radio"===e.type){const n=document.querySelector(`label[for="${e.getAttribute("id")}"]`);"label"===(null==(t=null==(s=e.parentElement)?void 0:s.tagName)?void 0:t.toLowerCase())?null==(r=null==(l=e.parentElement)?void 0:l.parentElement)||r.appendChild(i):n?null==(o=n.parentElement)||o.appendChild(i):null==(a=e.parentElement)||a.appendChild(i)}else null==(n=e.parentElement)||n.appendChild(i)}renderErrors(){var e,i,s,t,l,r;if(this.isSubmitted){this.clearErrors(),this.isValid=!0;for(const s in this.groupFields){const t=this.groupFields[s];if(t.isValid){t.elems.forEach((e=>{var i,s;Object.assign(e.style,(null==(i=t.config)?void 0:i.successFieldStyle)||this.globalConfig.successFieldStyle),e.classList.add((null==(s=t.config)?void 0:s.successFieldCssClass)||this.globalConfig.successFieldCssClass)}));const e=this.createSuccessLabelElem(s,t.successMessage,t.config);e&&t.groupElem.appendChild(e);continue}this.isValid=!1,t.elems.forEach((e=>{var i,s;Object.assign(e.style,(null==(i=t.config)?void 0:i.errorFieldStyle)||this.globalConfig.errorFieldStyle),e.classList.add((null==(s=t.config)?void 0:s.errorFieldCssClass)||this.globalConfig.errorFieldCssClass)}));const l=this.createErrorLabelElem(s,t.errorMessage,t.config);t.groupElem.appendChild(l),this.isTooltip()&&this.tooltips.push(this.renderTooltip(t.groupElem,l,null==(i=null==(e=t.config)?void 0:e.tooltip)?void 0:i.position))}for(const e in this.fields){const i=this.fields[e];if(i.isValid){if(!i.asyncCheckPending){const t=this.createSuccessLabelElem(e,i.successMessage,i.config);t&&this.renderFieldLabel(i.elem,t),i.elem.classList.add((null==(s=i.config)?void 0:s.successFieldCssClass)||this.globalConfig.successFieldCssClass)}continue}this.isValid=!1,i.elem.classList.add((null==(t=i.config)?void 0:t.errorFieldCssClass)||this.globalConfig.errorFieldCssClass);const o=this.createErrorLabelElem(e,i.errorMessage,i.config);this.renderFieldLabel(i.elem,o),this.isTooltip()&&this.tooltips.push(this.renderTooltip(i.elem,o,null==(r=null==(l=i.config)?void 0:l.tooltip)?void 0:r.position))}}}destroy(){this.eventListeners.forEach((e=>{this.removeListener(e.type,e.elem,e.func)})),Object.keys(this.customStyleTags).forEach((e=>{this.customStyleTags[e].remove()})),this.clearErrors(),this.globalConfig.lockForm&&this.unlockForm()}refresh(){this.destroy(),this.form?(this.initialize(this.form,this.globalConfig),Object.keys(this.fields).forEach((e=>{this.addField(e,[...this.fields[e].rules],this.fields[e].config)}))):console.error("Cannot initialize the library! Form is not defined")}setCurrentLocale(e){"string"==typeof e||void 0===e?(this.currentLocale=e,this.isSubmitted&&this.validate()):console.error("Current locale should be a string")}onSuccess(e){return this.onSuccessCallback=e,this}onFail(e){return this.onFailCallback=e,this}}}));
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYnMvanVzdC12YWxpZGF0ZS1uZXcubWluLmpzIl0sIm5hbWVzIjpbIl8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsInciLCJnZXRPd25Qcm9wZXJ0eVN5bWJvbHMiLCJYIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJaIiwicHJvcGVydHlJc0VudW1lcmFibGUiLCJFIiwicCIsImIiLCJnIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwidmFsdWUiLCJMIiwiY2FsbCIsInUiLCJleHBvcnRzIiwibW9kdWxlIiwiZGVmaW5lIiwiYW1kIiwiZ2xvYmFsVGhpcyIsInNlbGYiLCJKdXN0VmFsaWRhdGUiLCJ0aGlzIiwieCIsImQiLCJuIiwieSIsImsiLCJSZXF1aXJlZCIsIkVtYWlsIiwiTWluTGVuZ3RoIiwiTWF4TGVuZ3RoIiwiUGFzc3dvcmQiLCJOdW1iZXIiLCJNYXhOdW1iZXIiLCJNaW5OdW1iZXIiLCJTdHJvbmdQYXNzd29yZCIsIkN1c3RvbVJlZ2V4cCIsIk1pbkZpbGVzQ291bnQiLCJNYXhGaWxlc0NvdW50IiwiRmlsZXMiLCJMYWJlbCIsIkxhYmVsQXJyb3ciLCJGIiwidGhlbiIsIlMiLCJlcnJvckZpZWxkU3R5bGUiLCJjb2xvciIsImJvcmRlciIsImVycm9yRmllbGRDc3NDbGFzcyIsInN1Y2Nlc3NGaWVsZENzc0NsYXNzIiwiZXJyb3JMYWJlbFN0eWxlIiwiZXJyb3JMYWJlbENzc0NsYXNzIiwic3VjY2Vzc0xhYmVsQ3NzQ2xhc3MiLCJmb2N1c0ludmFsaWRGaWVsZCIsImxvY2tGb3JtIiwidGVzdGluZ01vZGUiLCJjb25zdHJ1Y3RvciIsImUiLCJ0IiwicyIsInRvb2x0aXBzIiwiZm9yRWFjaCIsInJlZnJlc2giLCJsYXN0U2Nyb2xsUG9zaXRpb24iLCJ3aW5kb3ciLCJzY3JvbGxZIiwiaXNTY3JvbGxUaWNrIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwicmVmcmVzaEFsbFRvb2x0aXBzIiwicHJldmVudERlZmF1bHQiLCJpc1N1Ym1pdHRlZCIsImdsb2JhbENvbmZpZyIsInZhbGlkYXRlIiwiZmluYWxseSIsInVubG9ja0Zvcm0iLCJpc1ZhbGlkIiwib25TdWNjZXNzQ2FsbGJhY2siLCJvbkZhaWxDYWxsYmFjayIsImZpZWxkcyIsImkiLCJyIiwiZWxlbSIsInZhbGlkYXRlRmllbGQiLCJncm91cEZpZWxkcyIsImVsZW1zIiwiZmluZCIsImEiLCJ2YWxpZGF0ZUdyb3VwIiwidGFyZ2V0IiwiaGFuZGxlRmllbGRDaGFuZ2UiLCJoYW5kbGVHcm91cENoYW5nZSIsInJlbmRlckVycm9ycyIsImluaXRpYWxpemUiLCJmb3JtIiwiZXJyb3JzIiwiZXJyb3JMYWJlbHMiLCJldmVudExpc3RlbmVycyIsImN1c3RvbVN0eWxlVGFncyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIkVycm9yIiwic2V0Rm9ybSIsIkhUTUxGb3JtRWxlbWVudCIsImRpY3RMb2NhbGUiLCJpc1Rvb2x0aXAiLCJjcmVhdGVFbGVtZW50IiwidGV4dENvbnRlbnQiLCJoZWFkIiwiYXBwZW5kQ2hpbGQiLCJhZGRMaXN0ZW5lciIsImhhbmRsZURvY3VtZW50U2Nyb2xsIiwiZ2V0TG9jYWxpc2VkU3RyaW5nIiwiY3VycmVudExvY2FsZSIsImxlbmd0aCIsImtleSIsImRpY3QiLCJnZXRGaWVsZEVycm9yTWVzc2FnZSIsImVycm9yTWVzc2FnZSIsImdldEVsZW1WYWx1ZSIsInJlcGxhY2UiLCJTdHJpbmciLCJOIiwicnVsZSIsImdldEZpZWxkU3VjY2Vzc01lc3NhZ2UiLCJnZXRHcm91cEVycm9yTWVzc2FnZSIsInEiLCJnZXRHcm91cFN1Y2Nlc3NNZXNzYWdlIiwic3VjY2Vzc01lc3NhZ2UiLCJzZXRGaWVsZEludmFsaWQiLCJzZXRGaWVsZFZhbGlkIiwic2V0R3JvdXBJbnZhbGlkIiwic2V0R3JvdXBWYWxpZCIsInR5cGUiLCJjaGVja2VkIiwiZmlsZXMiLCJ2YWxpZGF0ZUdyb3VwUnVsZSIsImV2ZXJ5IiwidmFsaWRhdGVGaWVsZFJ1bGUiLCJwbHVnaW4iLCJ0cmltIiwiSSIsInRlc3QiLCJUIiwiY29uc29sZSIsImVycm9yIiwiJCIsIk0iLCJQIiwiaiIsIlYiLCJsIiwiaXNOYU4iLCJHIiwiQSIsIlJlZ0V4cCIsIm8iLCJpc0Zpbml0ZSIsImMiLCJoIiwiZiIsIm1pblNpemUiLCJzaXplIiwibSIsIm1heFNpemUiLCJ2IiwiQXJyYXkiLCJpc0FycmF5IiwibmFtZXMiLCJpbmNsdWRlcyIsIm5hbWUiLCJEIiwiZXh0ZW5zaW9ucyIsInNwbGl0IiwiSCIsInR5cGVzIiwiaXRlbSIsInZhbGlkYXRvciIsImFzeW5jQ2hlY2tQZW5kaW5nIiwiY2F0Y2giLCJydWxlcyIsInJldmVyc2UiLCJwdXNoIiwiY29uZmlnIiwiUHJvbWlzZSIsImFsbFNldHRsZWQiLCJzZXRUaW1lb3V0IiwiZm9jdXMiLCJhZnRlclN1Ym1pdFZhbGlkYXRpb24iLCJrZXlzIiwic2V0QXR0cmlidXRlIiwicmVtb3ZlTGlzdGVuZXIiLCJmb3JtU3VibWl0SGFuZGxlciIsImFkZEV2ZW50TGlzdGVuZXIiLCJmdW5jIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImZpbHRlciIsImFkZEZpZWxkIiwidmFsdWVzIiwiam9pbiIsInNldExpc3RlbmVycyIsInJlbW92ZUZpZWxkIiwiZ2V0TGlzdGVuZXJUeXBlIiwiaGFuZGxlckNoYW5nZSIsImNsZWFyRXJyb3JzIiwicmVtb3ZlR3JvdXAiLCJhZGRSZXF1aXJlZEdyb3VwIiwicXVlcnlTZWxlY3RvckFsbCIsImZyb20iLCJncm91cEVsZW0iLCJpc0RpcnR5IiwicmVtb3ZlIiwic3VjY2Vzc0xhYmVscyIsInN0eWxlIiwic3VjY2Vzc0ZpZWxkU3R5bGUiLCJjbGFzc0xpc3QiLCJ0b29sdGlwIiwicG9pbnRlckV2ZW50cyIsIndlYmtpdEZpbHRlciIsInJlbW92ZUF0dHJpYnV0ZSIsInJlbmRlclRvb2x0aXAiLCJ0b3AiLCJsZWZ0Iiwid2lkdGgiLCJoZWlnaHQiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJwb3NpdGlvbiIsImRhdGFzZXQiLCJkaXJlY3Rpb24iLCJjcmVhdGVFcnJvckxhYmVsRWxlbSIsImlubmVySFRNTCIsImFzc2lnbiIsImFkZCIsInRlc3RJZCIsImNyZWF0ZVN1Y2Nlc3NMYWJlbEVsZW0iLCJzdWNjZXNzTGFiZWxTdHlsZSIsInJlbmRlckZpZWxkTGFiZWwiLCJnZXRBdHRyaWJ1dGUiLCJwYXJlbnRFbGVtZW50IiwidGFnTmFtZSIsInRvTG93ZXJDYXNlIiwiZGVzdHJveSIsInNldEN1cnJlbnRMb2NhbGUiLCJvblN1Y2Nlc3MiLCJvbkZhaWwiXSwibWFwcGluZ3MiOiJBQUFBLElBQUlBLEVBQUlDLE9BQU9DLGVBQ1hDLEVBQUlGLE9BQU9HLHNCQUNYQyxFQUFJSixPQUFPSyxVQUFVQyxlQUN2QkMsRUFBSVAsT0FBT0ssVUFBVUcscUJBQ25CQyxFQUFJLENBQUNDLEVBQUdDLEVBQUdDLElBQU1ELEtBQUtELEVBQUlYLEVBQUVXLEVBQUdDLEVBQUcsQ0FDbENFLFlBQVksRUFDWkMsY0FBYyxFQUNkQyxVQUFVLEVBQ1ZDLE1BQU9KLElBQ0pGLEVBQUVDLEdBQUtDLEVBQ1pLLEVBQUksQ0FBQ1AsRUFBR0MsS0FDTixJQUFLLElBQUlDLEtBQUtELElBQU1BLEVBQUksSUFBS1AsRUFBRWMsS0FBS1AsRUFBR0MsSUFBTUgsRUFBRUMsRUFBR0UsRUFBR0QsRUFBRUMsSUFDdkQsR0FBSVYsRUFDRixJQUFLLElBQUlVLEtBQUtWLEVBQUVTLEdBQUlKLEVBQUVXLEtBQUtQLEVBQUdDLElBQU1ILEVBQUVDLEVBQUdFLEVBQUdELEVBQUVDLElBQ2hELE9BQU9GLEdBRVBTLEVBQUksQ0FBQ1QsRUFBR0MsRUFBR0MsS0FBT0gsRUFBRUMsRUFBZSxpQkFBTEMsRUFBZ0JBLEVBQUksR0FBS0EsRUFBR0MsR0FBSUEsSUFDbEUsU0FBV0YsRUFBR0MsR0FDTSxpQkFBWFMsU0FBd0Msb0JBQVZDLE9BQXdCQSxPQUFPRCxRQUFVVCxJQUF1QixtQkFBVlcsUUFBd0JBLE9BQU9DLElBQU1ELE9BQU9YLElBQU1ELEVBQXlCLG9C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WixVQUNFekMsS0FBSzJOLFVBQVczTixLQUFLd0UsTUFBUXhFLEtBQUt1RSxXQUFXdkUsS0FBS3dFLEtBQU14RSxLQUFLa0QsY0FBZTdFLE9BQU9rTSxLQUFLdkssS0FBS3lELFFBQVFqQixTQUFRSixJQUMzR3BDLEtBQUsrSyxTQUFTM0ksRUFBRyxJQUFJcEMsS0FBS3lELE9BQU9yQixHQUFHMEgsT0FBUTlKLEtBQUt5RCxPQUFPckIsR0FBRzZILFlBQ3ZEdkMsUUFBUUMsTUFBTSxzREFFdEJpRyxpQkFBaUJ4TCxHQUNDLGlCQUFMQSxRQUF1QixJQUFOQSxHQUk1QnBDLEtBQUsyRixjQUFnQnZELEVBQUdwQyxLQUFLaUQsYUFBZWpELEtBQUttRCxZQUgvQ3VFLFFBQVFDLE1BQU0scUNBS2xCa0csVUFBVXpMLEdBQ1IsT0FBT3BDLEtBQUt1RCxrQkFBb0JuQixFQUFHcEMsS0FFckM4TixPQUFPMUwsR0FDTCxPQUFPcEMsS0FBS3dELGVBQWlCcEIsRUFBR3BDIiwiZmlsZSI6ImxpYnMvanVzdC12YWxpZGF0ZS1uZXcubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIF8gPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7XG52YXIgdyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHM7XG52YXIgWCA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHksXG4gIFogPSBPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlO1xudmFyIEUgPSAocCwgYiwgZykgPT4gYiBpbiBwID8gXyhwLCBiLCB7XG4gICAgZW51bWVyYWJsZTogITAsXG4gICAgY29uZmlndXJhYmxlOiAhMCxcbiAgICB3cml0YWJsZTogITAsXG4gICAgdmFsdWU6IGdcbiAgfSkgOiBwW2JdID0gZyxcbiAgTCA9IChwLCBiKSA9PiB7XG4gICAgZm9yICh2YXIgZyBpbiBiIHx8IChiID0ge30pKSBYLmNhbGwoYiwgZykgJiYgRShwLCBnLCBiW2ddKTtcbiAgICBpZiAodylcbiAgICAgIGZvciAodmFyIGcgb2YgdyhiKSkgWi5jYWxsKGIsIGcpICYmIEUocCwgZywgYltnXSk7XG4gICAgcmV0dXJuIHBcbiAgfTtcbnZhciB1ID0gKHAsIGIsIGcpID0+IChFKHAsIHR5cGVvZiBiICE9IFwic3ltYm9sXCIgPyBiICsgXCJcIiA6IGIsIGcpLCBnKTtcbihmdW5jdGlvbiAocCwgYikge1xuICB0eXBlb2YgZXhwb3J0cyA9PSBcIm9iamVjdFwiICYmIHR5cGVvZiBtb2R1bGUgIT0gXCJ1bmRlZmluZWRcIiA/IG1vZHVsZS5leHBvcnRzID0gYigpIDogdHlwZW9mIGRlZmluZSA9PSBcImZ1bmN0aW9uXCIgJiYgZGVmaW5lLmFtZCA/IGRlZmluZShiKSA6IChwID0gdHlwZW9mIGdsb2JhbFRoaXMgIT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbFRoaXMgOiBwIHx8IHNlbGYsIHAuSnVzdFZhbGlkYXRlID0gYigpKVxufSkodGhpcywgZnVuY3Rpb24gKCkge1xuICBcInVzZSBzdHJpY3RcIjtcbiAgY29uc3QgcCA9IC9eKChbXjw+KClbXFxdXFxcXC4sOzpcXHNAXCJdKyhcXC5bXjw+KClbXFxdXFxcXC4sOzpcXHNAXCJdKykqKXwoXCIuK1wiKSlAKChcXFtbMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XSl8KChbYS16QS1aXFwtMC05XStcXC4pK1thLXpBLVpdezIsfSkpJC8sXG4gICAgYiA9IC9eWzAtOV0rJC8sXG4gICAgZyA9IC9eKD89LipbQS1aYS16XSkoPz0uKlxcZClbQS1aYS16XFxkXXs4LH0kLyxcbiAgICB4ID0gL14oPz0uKlthLXpdKSg/PS4qW0EtWl0pKD89LipcXGQpKD89LipbQCQhJSo/Jl0pW0EtWmEtelxcZEAkISUqPyZdezgsfSQvLFxuICAgIEkgPSBuID0+IHtcbiAgICAgIGxldCBlID0gbjtcbiAgICAgIHJldHVybiB0eXBlb2YgbiA9PSBcInN0cmluZ1wiICYmIChlID0gbi50cmltKCkpLCAhZVxuICAgIH0sXG4gICAgVCA9IG4gPT4gcC50ZXN0KG4pLFxuICAgICQgPSAobiwgZSkgPT4gbi5sZW5ndGggPiBlLFxuICAgIE0gPSAobiwgZSkgPT4gbi5sZW5ndGggPCBlLFxuICAgIFYgPSBuID0+IGIudGVzdChuKSxcbiAgICBQID0gbiA9PiBnLnRlc3QobiksXG4gICAgaiA9IG4gPT4geC50ZXN0KG4pLFxuICAgIEcgPSAobiwgZSkgPT4gbiA+IGUsXG4gICAgQSA9IChuLCBlKSA9PiBuIDwgZTtcbiAgdmFyIGQ7XG4gIChmdW5jdGlvbiAobikge1xuICAgIG4uUmVxdWlyZWQgPSBcInJlcXVpcmVkXCIsIG4uRW1haWwgPSBcImVtYWlsXCIsIG4uTWluTGVuZ3RoID0gXCJtaW5MZW5ndGhcIiwgbi5NYXhMZW5ndGggPSBcIm1heExlbmd0aFwiLCBuLlBhc3N3b3JkID0gXCJwYXNzd29yZFwiLCBuLk51bWJlciA9IFwibnVtYmVyXCIsIG4uTWF4TnVtYmVyID0gXCJtYXhOdW1iZXJcIiwgbi5NaW5OdW1iZXIgPSBcIm1pbk51bWJlclwiLCBuLlN0cm9uZ1Bhc3N3b3JkID0gXCJzdHJvbmdQYXNzd29yZFwiLCBuLkN1c3RvbVJlZ2V4cCA9IFwiY3VzdG9tUmVnZXhwXCIsIG4uTWluRmlsZXNDb3VudCA9IFwibWluRmlsZXNDb3VudFwiLCBuLk1heEZpbGVzQ291bnQgPSBcIm1heEZpbGVzQ291bnRcIiwgbi5GaWxlcyA9IFwiZmlsZXNcIlxuICB9KShkIHx8IChkID0ge30pKTtcbiAgdmFyIHk7XG4gIChmdW5jdGlvbiAobikge1xuICAgIG4uUmVxdWlyZWQgPSBcInJlcXVpcmVkXCJcbiAgfSkoeSB8fCAoeSA9IHt9KSk7XG4gIHZhciBrO1xuICAoZnVuY3Rpb24gKG4pIHtcbiAgICBuLkxhYmVsID0gXCJsYWJlbFwiLCBuLkxhYmVsQXJyb3cgPSBcImxhYmVsQXJyb3dcIlxuICB9KShrIHx8IChrID0ge30pKTtcbiAgY29uc3QgTiA9IChuLCBlKSA9PiB7XG4gICAgICBzd2l0Y2ggKG4pIHtcbiAgICAgICAgY2FzZSBkLlJlcXVpcmVkOlxuICAgICAgICAgIHJldHVybiBcIlRoZSBmaWVsZCBpcyByZXF1aXJlZFwiO1xuICAgICAgICBjYXNlIGQuRW1haWw6XG4gICAgICAgICAgcmV0dXJuIFwiRW1haWwgaGFzIGludmFsaWQgZm9ybWF0XCI7XG4gICAgICAgIGNhc2UgZC5NYXhMZW5ndGg6XG4gICAgICAgICAgcmV0dXJuIFwiVGhlIGZpZWxkIG11c3QgY29udGFpbiBhIG1heGltdW0gb2YgOnZhbHVlIGNoYXJhY3RlcnNcIi5yZXBsYWNlKFwiOnZhbHVlXCIsIFN0cmluZyhlKSk7XG4gICAgICAgIGNhc2UgZC5NaW5MZW5ndGg6XG4gICAgICAgICAgcmV0dXJuIFwiVGhlIGZpZWxkIG11c3QgY29udGFpbiBhIG1pbmltdW0gb2YgOnZhbHVlIGNoYXJhY3RlcnNcIi5yZXBsYWNlKFwiOnZhbHVlXCIsIFN0cmluZyhlKSk7XG4gICAgICAgIGNhc2UgZC5QYXNzd29yZDpcbiAgICAgICAgICByZXR1cm4gXCJQYXNzd29yZCBtdXN0IGNvbnRhaW4gbWluaW11bSBlaWdodCBjaGFyYWN0ZXJzLCBhdCBsZWFzdCBvbmUgbGV0dGVyIGFuZCBvbmUgbnVtYmVyXCI7XG4gICAgICAgIGNhc2UgZC5OdW1iZXI6XG4gICAgICAgICAgcmV0dXJuIFwiVmFsdWUgc2hvdWxkIGJlIGEgbnVtYmVyXCI7XG4gICAgICAgIGNhc2UgZC5TdHJvbmdQYXNzd29yZDpcbiAgICAgICAgICByZXR1cm4gXCJQYXNzd29yZCBzaG91bGQgY29udGFpbiBtaW5pbXVtIGVpZ2h0IGNoYXJhY3RlcnMsIGF0IGxlYXN0IG9uZSB1cHBlcmNhc2UgbGV0dGVyLCBvbmUgbG93ZXJjYXNlIGxldHRlciwgb25lIG51bWJlciBhbmQgb25lIHNwZWNpYWwgY2hhcmFjdGVyXCI7XG4gICAgICAgIGNhc2UgZC5NYXhOdW1iZXI6XG4gICAgICAgICAgcmV0dXJuIFwiTnVtYmVyIHNob3VsZCBiZSBsZXNzIG9yIGVxdWFsIHRoYW4gOnZhbHVlXCIucmVwbGFjZShcIjp2YWx1ZVwiLCBTdHJpbmcoZSkpO1xuICAgICAgICBjYXNlIGQuTWluTnVtYmVyOlxuICAgICAgICAgIHJldHVybiBcIk51bWJlciBzaG91bGQgYmUgbW9yZSBvciBlcXVhbCB0aGFuIDp2YWx1ZVwiLnJlcGxhY2UoXCI6dmFsdWVcIiwgU3RyaW5nKGUpKTtcbiAgICAgICAgY2FzZSBkLk1pbkZpbGVzQ291bnQ6XG4gICAgICAgICAgcmV0dXJuIFwiRmlsZXMgY291bnQgc2hvdWxkIGJlIG1vcmUgb3IgZXF1YWwgdGhhbiA6dmFsdWVcIi5yZXBsYWNlKFwiOnZhbHVlXCIsIFN0cmluZyhlKSk7XG4gICAgICAgIGNhc2UgZC5NYXhGaWxlc0NvdW50OlxuICAgICAgICAgIHJldHVybiBcIkZpbGVzIGNvdW50IHNob3VsZCBiZSBsZXNzIG9yIGVxdWFsIHRoYW4gOnZhbHVlXCIucmVwbGFjZShcIjp2YWx1ZVwiLCBTdHJpbmcoZSkpO1xuICAgICAgICBjYXNlIGQuRmlsZXM6XG4gICAgICAgICAgcmV0dXJuIFwiVXBsb2FkZWQgZmlsZXMgaGF2ZSBvbmUgb3Igc2V2ZXJhbCBpbnZhbGlkIHByb3BlcnRpZXMgKGV4dGVuc2lvbi9zaXplL3R5cGUgZXRjKVwiO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHJldHVybiBcIlZhbHVlIGlzIGluY29ycmVjdFwiXG4gICAgICB9XG4gICAgfSxcbiAgICBxID0gbiA9PiB7XG4gICAgICBzd2l0Y2ggKG4pIHtcbiAgICAgICAgY2FzZSB5LlJlcXVpcmVkOlxuICAgICAgICAgIHJldHVybiBcIlRoZSBmaWVsZCBpcyByZXF1aXJlZFwiO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHJldHVybiBcIkdyb3VwIGlzIGluY29ycmVjdFwiXG4gICAgICB9XG4gICAgfSxcbiAgICBGID0gbiA9PiAhIW4gJiYgdHlwZW9mIG4udGhlbiA9PSBcImZ1bmN0aW9uXCIsXG4gICAgeiA9IFwiLmp1c3QtdmFsaWRhdGUtZXJyb3ItbGFiZWxbZGF0YS10b29sdGlwPXRydWVde3Bvc2l0aW9uOmZpeGVkO3BhZGRpbmc6NHB4IDhweDtiYWNrZ3JvdW5kOiM0MjNmM2Y7Y29sb3I6I2ZmZjt3aGl0ZS1zcGFjZTpub3dyYXA7ei1pbmRleDoxMDtib3JkZXItcmFkaXVzOjRweDt0cmFuc2Zvcm06dHJhbnNsYXRlWSgtNXB4KX0uanVzdC12YWxpZGF0ZS1lcnJvci1sYWJlbFtkYXRhLXRvb2x0aXA9dHJ1ZV06YmVmb3Jle2NvbnRlbnQ6Jyc7d2lkdGg6MDtoZWlnaHQ6MDtib3JkZXItbGVmdDpzb2xpZCA1cHggdHJhbnNwYXJlbnQ7Ym9yZGVyLXJpZ2h0OnNvbGlkIDVweCB0cmFuc3BhcmVudDtib3JkZXItYm90dG9tOnNvbGlkIDVweCAjNDIzZjNmO3Bvc2l0aW9uOmFic29sdXRlO3otaW5kZXg6MztkaXNwbGF5OmJsb2NrO2JvdHRvbTotNXB4O3RyYW5zZm9ybTpyb3RhdGUoMTgwZGVnKTtsZWZ0OmNhbGMoNTAlIC0gNXB4KX0uanVzdC12YWxpZGF0ZS1lcnJvci1sYWJlbFtkYXRhLXRvb2x0aXA9dHJ1ZV1bZGF0YS1kaXJlY3Rpb249bGVmdF17dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTVweCl9Lmp1c3QtdmFsaWRhdGUtZXJyb3ItbGFiZWxbZGF0YS10b29sdGlwPXRydWVdW2RhdGEtZGlyZWN0aW9uPWxlZnRdOmJlZm9yZXtyaWdodDotN3B4O2JvdHRvbTphdXRvO2xlZnQ6YXV0bzt0b3A6Y2FsYyg1MCUgLSAycHgpO3RyYW5zZm9ybTpyb3RhdGUoOTBkZWcpfS5qdXN0LXZhbGlkYXRlLWVycm9yLWxhYmVsW2RhdGEtdG9vbHRpcD10cnVlXVtkYXRhLWRpcmVjdGlvbj1yaWdodF17dHJhbnNmb3JtOnRyYW5zbGF0ZVgoNXB4KX0uanVzdC12YWxpZGF0ZS1lcnJvci1sYWJlbFtkYXRhLXRvb2x0aXA9dHJ1ZV1bZGF0YS1kaXJlY3Rpb249cmlnaHRdOmJlZm9yZXtyaWdodDphdXRvO2JvdHRvbTphdXRvO2xlZnQ6LTdweDt0b3A6Y2FsYyg1MCUgLSAycHgpO3RyYW5zZm9ybTpyb3RhdGUoLTkwZGVnKX0uanVzdC12YWxpZGF0ZS1lcnJvci1sYWJlbFtkYXRhLXRvb2x0aXA9dHJ1ZV1bZGF0YS1kaXJlY3Rpb249Ym90dG9tXXt0cmFuc2Zvcm06dHJhbnNsYXRlWSg1cHgpfS5qdXN0LXZhbGlkYXRlLWVycm9yLWxhYmVsW2RhdGEtdG9vbHRpcD10cnVlXVtkYXRhLWRpcmVjdGlvbj1ib3R0b21dOmJlZm9yZXtyaWdodDphdXRvO2JvdHRvbTphdXRvO2xlZnQ6Y2FsYyg1MCUgLSA1cHgpO3RvcDotNXB4O3RyYW5zZm9ybTpyb3RhdGUoMCl9XCIsXG4gICAgQyA9IDUsXG4gICAgUyA9IHtcbiAgICAgIGVycm9yRmllbGRTdHlsZToge1xuICAgICAgICBjb2xvcjogXCIjYjgxMTExXCIsXG4gICAgICAgIGJvcmRlcjogXCIxcHggc29saWQgI0I4MTExMVwiXG4gICAgICB9LFxuICAgICAgZXJyb3JGaWVsZENzc0NsYXNzOiBcImp1c3QtdmFsaWRhdGUtZXJyb3ItZmllbGRcIixcbiAgICAgIHN1Y2Nlc3NGaWVsZENzc0NsYXNzOiBcImp1c3QtdmFsaWRhdGUtc3VjY2Vzcy1maWVsZFwiLFxuICAgICAgZXJyb3JMYWJlbFN0eWxlOiB7XG4gICAgICAgIGNvbG9yOiBcIiNiODExMTFcIlxuICAgICAgfSxcbiAgICAgIGVycm9yTGFiZWxDc3NDbGFzczogXCJqdXN0LXZhbGlkYXRlLWVycm9yLWxhYmVsXCIsXG4gICAgICBzdWNjZXNzTGFiZWxDc3NDbGFzczogXCJqdXN0LXZhbGlkYXRlLXN1Y2Nlc3MtbGFiZWxcIixcbiAgICAgIGZvY3VzSW52YWxpZEZpZWxkOiAhMCxcbiAgICAgIGxvY2tGb3JtOiAhMCxcbiAgICAgIHRlc3RpbmdNb2RlOiAhMVxuICAgIH07XG4gIGNsYXNzIE8ge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQsIHMpIHtcbiAgICAgIHUodGhpcywgXCJmb3JtXCIsIG51bGwpO1xuICAgICAgdSh0aGlzLCBcImZpZWxkc1wiLCB7fSk7XG4gICAgICB1KHRoaXMsIFwiZ3JvdXBGaWVsZHNcIiwge30pO1xuICAgICAgdSh0aGlzLCBcImVycm9yc1wiLCB7fSk7XG4gICAgICB1KHRoaXMsIFwiaXNWYWxpZFwiLCAhMSk7XG4gICAgICB1KHRoaXMsIFwiaXNTdWJtaXR0ZWRcIiwgITEpO1xuICAgICAgdSh0aGlzLCBcImdsb2JhbENvbmZpZ1wiLCBTKTtcbiAgICAgIHUodGhpcywgXCJlcnJvckxhYmVsc1wiLCBbXSk7XG4gICAgICB1KHRoaXMsIFwic3VjY2Vzc0xhYmVsc1wiLCBbXSk7XG4gICAgICB1KHRoaXMsIFwiZXZlbnRMaXN0ZW5lcnNcIiwgW10pO1xuICAgICAgdSh0aGlzLCBcImRpY3RMb2NhbGVcIiwgW10pO1xuICAgICAgdSh0aGlzLCBcImN1cnJlbnRMb2NhbGVcIik7XG4gICAgICB1KHRoaXMsIFwiY3VzdG9tU3R5bGVUYWdzXCIsIHt9KTtcbiAgICAgIHUodGhpcywgXCJvblN1Y2Nlc3NDYWxsYmFja1wiKTtcbiAgICAgIHUodGhpcywgXCJvbkZhaWxDYWxsYmFja1wiKTtcbiAgICAgIHUodGhpcywgXCJ0b29sdGlwc1wiLCBbXSk7XG4gICAgICB1KHRoaXMsIFwibGFzdFNjcm9sbFBvc2l0aW9uXCIpO1xuICAgICAgdSh0aGlzLCBcImlzU2Nyb2xsVGlja1wiKTtcbiAgICAgIHUodGhpcywgXCJyZWZyZXNoQWxsVG9vbHRpcHNcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLnRvb2x0aXBzLmZvckVhY2goZSA9PiB7XG4gICAgICAgICAgZS5yZWZyZXNoKClcbiAgICAgICAgfSlcbiAgICAgIH0pO1xuICAgICAgdSh0aGlzLCBcImhhbmRsZURvY3VtZW50U2Nyb2xsXCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5sYXN0U2Nyb2xsUG9zaXRpb24gPSB3aW5kb3cuc2Nyb2xsWSwgdGhpcy5pc1Njcm9sbFRpY2sgfHwgKHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgICAgIHRoaXMucmVmcmVzaEFsbFRvb2x0aXBzKCksIHRoaXMuaXNTY3JvbGxUaWNrID0gITFcbiAgICAgICAgfSksIHRoaXMuaXNTY3JvbGxUaWNrID0gITApXG4gICAgICB9KTtcbiAgICAgIHUodGhpcywgXCJmb3JtU3VibWl0SGFuZGxlclwiLCBlID0+IHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpLCB0aGlzLmlzU3VibWl0dGVkID0gITAsIHRoaXMuZ2xvYmFsQ29uZmlnLmxvY2tGb3JtICYmIHRoaXMubG9ja0Zvcm0oKSwgdGhpcy52YWxpZGF0ZSgpLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICAgIHZhciB0LCBzO1xuICAgICAgICAgIHRoaXMuZ2xvYmFsQ29uZmlnLmxvY2tGb3JtICYmIHRoaXMudW5sb2NrRm9ybSgpLCB0aGlzLmlzVmFsaWQgPyAodCA9IHRoaXMub25TdWNjZXNzQ2FsbGJhY2spID09IG51bGwgfHwgdC5jYWxsKHRoaXMsIGUpIDogKHMgPSB0aGlzLm9uRmFpbENhbGxiYWNrKSA9PSBudWxsIHx8IHMuY2FsbCh0aGlzLCB0aGlzLmZpZWxkcylcbiAgICAgICAgfSlcbiAgICAgIH0pO1xuICAgICAgdSh0aGlzLCBcImhhbmRsZUZpZWxkQ2hhbmdlXCIsIGUgPT4ge1xuICAgICAgICBsZXQgdCwgcztcbiAgICAgICAgZm9yIChjb25zdCBpIGluIHRoaXMuZmllbGRzKSB7XG4gICAgICAgICAgY29uc3QgciA9IHRoaXMuZmllbGRzW2ldO1xuICAgICAgICAgIGlmIChyLmVsZW0gPT09IGUpIHtcbiAgICAgICAgICAgIHQgPSByLCBzID0gaTtcbiAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgfVxuICAgICAgICB9IXQgfHwgIXMgfHwgdGhpcy52YWxpZGF0ZUZpZWxkKHMsIHQsICEwKVxuICAgICAgfSk7XG4gICAgICB1KHRoaXMsIFwiaGFuZGxlR3JvdXBDaGFuZ2VcIiwgZSA9PiB7XG4gICAgICAgIGxldCB0LCBzO1xuICAgICAgICBmb3IgKGNvbnN0IGkgaW4gdGhpcy5ncm91cEZpZWxkcykge1xuICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmdyb3VwRmllbGRzW2ldO1xuICAgICAgICAgIGlmIChyLmVsZW1zLmZpbmQoYSA9PiBhID09PSBlKSkge1xuICAgICAgICAgICAgdCA9IHIsIHMgPSBpO1xuICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICB9XG4gICAgICAgIH0hdCB8fCAhcyB8fCB0aGlzLnZhbGlkYXRlR3JvdXAocywgdClcbiAgICAgIH0pO1xuICAgICAgdSh0aGlzLCBcImhhbmRsZXJDaGFuZ2VcIiwgZSA9PiB7XG4gICAgICAgICFlLnRhcmdldCB8fCAodGhpcy5oYW5kbGVGaWVsZENoYW5nZShlLnRhcmdldCksIHRoaXMuaGFuZGxlR3JvdXBDaGFuZ2UoZS50YXJnZXQpLCB0aGlzLnJlbmRlckVycm9ycygpKVxuICAgICAgfSk7XG4gICAgICB0aGlzLmluaXRpYWxpemUoZSwgdCwgcylcbiAgICB9XG4gICAgaW5pdGlhbGl6ZShlLCB0LCBzKSB7XG4gICAgICBpZiAodGhpcy5mb3JtID0gbnVsbCwgdGhpcy5lcnJvcnMgPSB7fSwgdGhpcy5pc1ZhbGlkID0gITEsIHRoaXMuaXNTdWJtaXR0ZWQgPSAhMSwgdGhpcy5nbG9iYWxDb25maWcgPSBTLCB0aGlzLmVycm9yTGFiZWxzID0gW10sIHRoaXMuZXZlbnRMaXN0ZW5lcnMgPSBbXSwgdGhpcy5jdXN0b21TdHlsZVRhZ3MgPSB7fSwgdGhpcy50b29sdGlwcyA9IFtdLCB0eXBlb2YgZSA9PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIGNvbnN0IGkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGUpO1xuICAgICAgICBpZiAoIWkpIHRocm93IEVycm9yKGBGb3JtIHdpdGggJHtlfSBzZWxlY3RvciBub3QgZm91bmQhIFBsZWFzZSBjaGVjayB0aGUgZm9ybSBzZWxlY3RvcmApO1xuICAgICAgICB0aGlzLnNldEZvcm0oaSlcbiAgICAgIH0gZWxzZSBpZiAoZSBpbnN0YW5jZW9mIEhUTUxGb3JtRWxlbWVudCkgdGhpcy5zZXRGb3JtKGUpO1xuICAgICAgZWxzZSB0aHJvdyBFcnJvcihcIkZvcm0gc2VsZWN0b3IgaXMgbm90IHZhbGlkLiBQbGVhc2Ugc3BlY2lmeSBhIHN0cmluZyBzZWxlY3RvciBvciBhIERPTSBlbGVtZW50LlwiKTtcbiAgICAgIGlmICh0aGlzLmdsb2JhbENvbmZpZyA9IEwoTCh7fSwgUyksIHQpLCBzICYmICh0aGlzLmRpY3RMb2NhbGUgPSBzKSwgdGhpcy5pc1Rvb2x0aXAoKSkge1xuICAgICAgICBjb25zdCBpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO1xuICAgICAgICBpLnRleHRDb250ZW50ID0geiwgdGhpcy5jdXN0b21TdHlsZVRhZ3Nbay5MYWJlbF0gPSBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGkpLCB0aGlzLmFkZExpc3RlbmVyKFwic2Nyb2xsXCIsIGRvY3VtZW50LCB0aGlzLmhhbmRsZURvY3VtZW50U2Nyb2xsKVxuICAgICAgfVxuICAgIH1cbiAgICBnZXRMb2NhbGlzZWRTdHJpbmcoZSkge1xuICAgICAgdmFyIHM7XG4gICAgICByZXR1cm4gIXRoaXMuY3VycmVudExvY2FsZSB8fCAhdGhpcy5kaWN0TG9jYWxlLmxlbmd0aCA/IGUgOiAoKHMgPSB0aGlzLmRpY3RMb2NhbGUuZmluZChpID0+IGkua2V5ID09PSBlKSkgPT0gbnVsbCA/IHZvaWQgMCA6IHMuZGljdFt0aGlzLmN1cnJlbnRMb2NhbGVdKSB8fCBlXG4gICAgfVxuICAgIGdldEZpZWxkRXJyb3JNZXNzYWdlKGUsIHQpIHtcbiAgICAgIGNvbnN0IHMgPSB0eXBlb2YgZS5lcnJvck1lc3NhZ2UgPT0gXCJmdW5jdGlvblwiID8gZS5lcnJvck1lc3NhZ2UodGhpcy5nZXRFbGVtVmFsdWUodCksIHRoaXMuZmllbGRzKSA6IGUuZXJyb3JNZXNzYWdlO1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0TG9jYWxpc2VkU3RyaW5nKHMpIHx8IE4oZS5ydWxlLCBlLnZhbHVlKVxuICAgIH1cbiAgICBnZXRGaWVsZFN1Y2Nlc3NNZXNzYWdlKGUsIHQpIHtcbiAgICAgIGNvbnN0IHMgPSB0eXBlb2YgZSA9PSBcImZ1bmN0aW9uXCIgPyBlKHRoaXMuZ2V0RWxlbVZhbHVlKHQpLCB0aGlzLmZpZWxkcykgOiBlO1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0TG9jYWxpc2VkU3RyaW5nKHMpXG4gICAgfVxuICAgIGdldEdyb3VwRXJyb3JNZXNzYWdlKGUpIHtcbiAgICAgIHJldHVybiB0aGlzLmdldExvY2FsaXNlZFN0cmluZyhlLmVycm9yTWVzc2FnZSkgfHwgcShlLnJ1bGUpXG4gICAgfVxuICAgIGdldEdyb3VwU3VjY2Vzc01lc3NhZ2UoZSkge1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0TG9jYWxpc2VkU3RyaW5nKGUuc3VjY2Vzc01lc3NhZ2UpXG4gICAgfVxuICAgIHNldEZpZWxkSW52YWxpZChlLCB0KSB7XG4gICAgICB0aGlzLmZpZWxkc1tlXS5pc1ZhbGlkID0gITEsIHRoaXMuZmllbGRzW2VdLmVycm9yTWVzc2FnZSA9IHRoaXMuZ2V0RmllbGRFcnJvck1lc3NhZ2UodCwgdGhpcy5maWVsZHNbZV0uZWxlbSlcbiAgICB9XG4gICAgc2V0RmllbGRWYWxpZChlLCB0KSB7XG4gICAgICB0aGlzLmZpZWxkc1tlXS5pc1ZhbGlkID0gITAsIHQgIT09IHZvaWQgMCAmJiAodGhpcy5maWVsZHNbZV0uc3VjY2Vzc01lc3NhZ2UgPSB0aGlzLmdldEZpZWxkU3VjY2Vzc01lc3NhZ2UodCwgdGhpcy5maWVsZHNbZV0uZWxlbSkpXG4gICAgfVxuICAgIHNldEdyb3VwSW52YWxpZChlLCB0KSB7XG4gICAgICB0aGlzLmdyb3VwRmllbGRzW2VdLmlzVmFsaWQgPSAhMSwgdGhpcy5ncm91cEZpZWxkc1tlXS5lcnJvck1lc3NhZ2UgPSB0aGlzLmdldEdyb3VwRXJyb3JNZXNzYWdlKHQpXG4gICAgfVxuICAgIHNldEdyb3VwVmFsaWQoZSwgdCkge1xuICAgICAgdGhpcy5ncm91cEZpZWxkc1tlXS5pc1ZhbGlkID0gITAsIHRoaXMuZ3JvdXBGaWVsZHNbZV0uc3VjY2Vzc01lc3NhZ2UgPSB0aGlzLmdldEdyb3VwU3VjY2Vzc01lc3NhZ2UodClcbiAgICB9XG4gICAgZ2V0RWxlbVZhbHVlKGUpIHtcbiAgICAgIHN3aXRjaCAoZS50eXBlKSB7XG4gICAgICAgIGNhc2UgXCJjaGVja2JveFwiOlxuICAgICAgICAgIHJldHVybiBlLmNoZWNrZWQ7XG4gICAgICAgIGNhc2UgXCJmaWxlXCI6XG4gICAgICAgICAgcmV0dXJuIGUuZmlsZXM7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgcmV0dXJuIGUudmFsdWVcbiAgICAgIH1cbiAgICB9XG4gICAgdmFsaWRhdGVHcm91cFJ1bGUoZSwgdCwgcywgaSkge1xuICAgICAgc3dpdGNoIChpLnJ1bGUpIHtcbiAgICAgICAgY2FzZSB5LlJlcXVpcmVkOlxuICAgICAgICAgICh0ID09PSBcInJhZGlvXCIgfHwgdCA9PT0gXCJjaGVja2JveFwiKSAmJiAocy5ldmVyeShyID0+ICFyLmNoZWNrZWQpID8gdGhpcy5zZXRHcm91cEludmFsaWQoZSwgaSkgOiB0aGlzLnNldEdyb3VwVmFsaWQoZSwgaSkpXG4gICAgICB9XG4gICAgfVxuICAgIHZhbGlkYXRlRmllbGRSdWxlKGUsIHQsIHMsIGkgPSAhMSkge1xuICAgICAgY29uc3QgciA9IHMudmFsdWUsXG4gICAgICAgIGEgPSB0aGlzLmdldEVsZW1WYWx1ZSh0KTtcbiAgICAgIGlmIChzLnBsdWdpbikge1xuICAgICAgICBzLnBsdWdpbihhLCB0aGlzLmZpZWxkcykgfHwgdGhpcy5zZXRGaWVsZEludmFsaWQoZSwgcyk7XG4gICAgICAgIHJldHVyblxuICAgICAgfVxuICAgICAgc3dpdGNoIChzLnJ1bGUpIHtcbiAgICAgICAgY2FzZSBkLlJlcXVpcmVkOiB7XG4gICAgICAgICAgSShhKSAmJiB0aGlzLnNldEZpZWxkSW52YWxpZChlLCBzKTtcbiAgICAgICAgICBicmVha1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgZC5FbWFpbDoge1xuICAgICAgICAgIGlmICh0eXBlb2YgYSAhPSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICB0aGlzLnNldEZpZWxkSW52YWxpZChlLCBzKTtcbiAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgfVxuICAgICAgICAgIFQoYSkgfHwgdGhpcy5zZXRGaWVsZEludmFsaWQoZSwgcyk7XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIGQuTWF4TGVuZ3RoOiB7XG4gICAgICAgICAgaWYgKHIgPT09IHZvaWQgMCkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihgVmFsdWUgZm9yICR7cy5ydWxlfSBydWxlIGZvciBbJHtlfV0gZmllbGQgaXMgbm90IGRlZmluZWQuIFRoZSBmaWVsZCB3aWxsIGJlIGFsd2F5cyBpbnZhbGlkLmApLCB0aGlzLnNldEZpZWxkSW52YWxpZChlLCBzKTtcbiAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh0eXBlb2YgciAhPSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBWYWx1ZSBmb3IgJHtzLnJ1bGV9IHJ1bGUgZm9yIFske2V9XSBzaG91bGQgYmUgYSBudW1iZXIuIFRoZSBmaWVsZCB3aWxsIGJlIGFsd2F5cyBpbnZhbGlkLmApLCB0aGlzLnNldEZpZWxkSW52YWxpZChlLCBzKTtcbiAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh0eXBlb2YgYSAhPSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICB0aGlzLnNldEZpZWxkSW52YWxpZChlLCBzKTtcbiAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChhID09PSBcIlwiKSBicmVhaztcbiAgICAgICAgICAkKGEsIHIpICYmIHRoaXMuc2V0RmllbGRJbnZhbGlkKGUsIHMpO1xuICAgICAgICAgIGJyZWFrXG4gICAgICAgIH1cbiAgICAgICAgY2FzZSBkLk1pbkxlbmd0aDoge1xuICAgICAgICAgIGlmIChyID09PSB2b2lkIDApIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFZhbHVlIGZvciAke3MucnVsZX0gcnVsZSBmb3IgWyR7ZX1dIGZpZWxkIGlzIG5vdCBkZWZpbmVkLiBUaGUgZmllbGQgd2lsbCBiZSBhbHdheXMgaW52YWxpZC5gKSwgdGhpcy5zZXRGaWVsZEludmFsaWQoZSwgcyk7XG4gICAgICAgICAgICBicmVha1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAodHlwZW9mIHIgIT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihgVmFsdWUgZm9yICR7cy5ydWxlfSBydWxlIGZvciBbJHtlfV0gc2hvdWxkIGJlIGEgbnVtYmVyLiBUaGUgZmllbGQgd2lsbCBiZSBhbHdheXMgaW52YWxpZC5gKSwgdGhpcy5zZXRGaWVsZEludmFsaWQoZSwgcyk7XG4gICAgICAgICAgICBicmVha1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAodHlwZW9mIGEgIT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdGhpcy5zZXRGaWVsZEludmFsaWQoZSwgcyk7XG4gICAgICAgICAgICBicmVha1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoYSA9PT0gXCJcIikgYnJlYWs7XG4gICAgICAgICAgTShhLCByKSAmJiB0aGlzLnNldEZpZWxkSW52YWxpZChlLCBzKTtcbiAgICAgICAgICBicmVha1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgZC5QYXNzd29yZDoge1xuICAgICAgICAgIGlmICh0eXBlb2YgYSAhPSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICB0aGlzLnNldEZpZWxkSW52YWxpZChlLCBzKTtcbiAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChhID09PSBcIlwiKSBicmVhaztcbiAgICAgICAgICBQKGEpIHx8IHRoaXMuc2V0RmllbGRJbnZhbGlkKGUsIHMpO1xuICAgICAgICAgIGJyZWFrXG4gICAgICAgIH1cbiAgICAgICAgY2FzZSBkLlN0cm9uZ1Bhc3N3b3JkOiB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBhICE9IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0RmllbGRJbnZhbGlkKGUsIHMpO1xuICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGEgPT09IFwiXCIpIGJyZWFrO1xuICAgICAgICAgIGooYSkgfHwgdGhpcy5zZXRGaWVsZEludmFsaWQoZSwgcyk7XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIGQuTnVtYmVyOiB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBhICE9IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0RmllbGRJbnZhbGlkKGUsIHMpO1xuICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGEgPT09IFwiXCIpIGJyZWFrO1xuICAgICAgICAgIFYoYSkgfHwgdGhpcy5zZXRGaWVsZEludmFsaWQoZSwgcyk7XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIGQuTWF4TnVtYmVyOiB7XG4gICAgICAgICAgaWYgKHIgPT09IHZvaWQgMCkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihgVmFsdWUgZm9yICR7cy5ydWxlfSBydWxlIGZvciBbJHtlfV0gZmllbGQgaXMgbm90IGRlZmluZWQuIFRoZSBmaWVsZCB3aWxsIGJlIGFsd2F5cyBpbnZhbGlkLmApLCB0aGlzLnNldEZpZWxkSW52YWxpZChlLCBzKTtcbiAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh0eXBlb2YgciAhPSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBWYWx1ZSBmb3IgJHtzLnJ1bGV9IHJ1bGUgZm9yIFske2V9XSBmaWVsZCBzaG91bGQgYmUgYSBudW1iZXIuIFRoZSBmaWVsZCB3aWxsIGJlIGFsd2F5cyBpbnZhbGlkLmApLCB0aGlzLnNldEZpZWxkSW52YWxpZChlLCBzKTtcbiAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh0eXBlb2YgYSAhPSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICB0aGlzLnNldEZpZWxkSW52YWxpZChlLCBzKTtcbiAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChhID09PSBcIlwiKSBicmVhaztcbiAgICAgICAgICBjb25zdCBsID0gK2E7XG4gICAgICAgICAgKE51bWJlci5pc05hTihsKSB8fCBHKGwsIHIpKSAmJiB0aGlzLnNldEZpZWxkSW52YWxpZChlLCBzKTtcbiAgICAgICAgICBicmVha1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgZC5NaW5OdW1iZXI6IHtcbiAgICAgICAgICBpZiAociA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBWYWx1ZSBmb3IgJHtzLnJ1bGV9IHJ1bGUgZm9yIFske2V9XSBmaWVsZCBpcyBub3QgZGVmaW5lZC4gVGhlIGZpZWxkIHdpbGwgYmUgYWx3YXlzIGludmFsaWQuYCksIHRoaXMuc2V0RmllbGRJbnZhbGlkKGUsIHMpO1xuICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHR5cGVvZiByICE9IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFZhbHVlIGZvciAke3MucnVsZX0gcnVsZSBmb3IgWyR7ZX1dIGZpZWxkIHNob3VsZCBiZSBhIG51bWJlci4gVGhlIGZpZWxkIHdpbGwgYmUgYWx3YXlzIGludmFsaWQuYCksIHRoaXMuc2V0RmllbGRJbnZhbGlkKGUsIHMpO1xuICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHR5cGVvZiBhICE9IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0RmllbGRJbnZhbGlkKGUsIHMpO1xuICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGEgPT09IFwiXCIpIGJyZWFrO1xuICAgICAgICAgIGNvbnN0IGwgPSArYTtcbiAgICAgICAgICAoTnVtYmVyLmlzTmFOKGwpIHx8IEEobCwgcikpICYmIHRoaXMuc2V0RmllbGRJbnZhbGlkKGUsIHMpO1xuICAgICAgICAgIGJyZWFrXG4gICAgICAgIH1cbiAgICAgICAgY2FzZSBkLkN1c3RvbVJlZ2V4cDoge1xuICAgICAgICAgIGlmIChyID09PSB2b2lkIDApIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFZhbHVlIGZvciAke3MucnVsZX0gcnVsZSBmb3IgWyR7ZX1dIGZpZWxkIGlzIG5vdCBkZWZpbmVkLiBUaGlzIGZpZWxkIHdpbGwgYmUgYWx3YXlzIGludmFsaWQuYCksIHRoaXMuc2V0RmllbGRJbnZhbGlkKGUsIHMpO1xuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgfVxuICAgICAgICAgIGxldCBsO1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBsID0gbmV3IFJlZ0V4cChyKVxuICAgICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihgVmFsdWUgZm9yICR7cy5ydWxlfSBydWxlIGZvciBbJHtlfV0gc2hvdWxkIGJlIGEgdmFsaWQgcmVnZXhwLiBUaGlzIGZpZWxkIHdpbGwgYmUgYWx3YXlzIGludmFsaWQuYCksIHRoaXMuc2V0RmllbGRJbnZhbGlkKGUsIHMpO1xuICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgbyA9IFN0cmluZyhhKTtcbiAgICAgICAgICBvICE9PSBcIlwiICYmICFsLnRlc3QobykgJiYgdGhpcy5zZXRGaWVsZEludmFsaWQoZSwgcyk7XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIGQuTWluRmlsZXNDb3VudDoge1xuICAgICAgICAgIGlmIChyID09PSB2b2lkIDApIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFZhbHVlIGZvciAke3MucnVsZX0gcnVsZSBmb3IgWyR7ZX1dIGZpZWxkIGlzIG5vdCBkZWZpbmVkLiBUaGlzIGZpZWxkIHdpbGwgYmUgYWx3YXlzIGludmFsaWQuYCksIHRoaXMuc2V0RmllbGRJbnZhbGlkKGUsIHMpO1xuICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHR5cGVvZiByICE9IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFZhbHVlIGZvciAke3MucnVsZX0gcnVsZSBmb3IgWyR7ZX1dIGZpZWxkIHNob3VsZCBiZSBhIG51bWJlci4gVGhlIGZpZWxkIHdpbGwgYmUgYWx3YXlzIGludmFsaWQuYCksIHRoaXMuc2V0RmllbGRJbnZhbGlkKGUsIHMpO1xuICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShhID09IG51bGwgPyB2b2lkIDAgOiBhLmxlbmd0aCkgJiYgYS5sZW5ndGggPCByKSB7XG4gICAgICAgICAgICB0aGlzLnNldEZpZWxkSW52YWxpZChlLCBzKTtcbiAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIH1cbiAgICAgICAgY2FzZSBkLk1heEZpbGVzQ291bnQ6IHtcbiAgICAgICAgICBpZiAociA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBWYWx1ZSBmb3IgJHtzLnJ1bGV9IHJ1bGUgZm9yIFske2V9XSBmaWVsZCBpcyBub3QgZGVmaW5lZC4gVGhpcyBmaWVsZCB3aWxsIGJlIGFsd2F5cyBpbnZhbGlkLmApLCB0aGlzLnNldEZpZWxkSW52YWxpZChlLCBzKTtcbiAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh0eXBlb2YgciAhPSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBWYWx1ZSBmb3IgJHtzLnJ1bGV9IHJ1bGUgZm9yIFske2V9XSBmaWVsZCBzaG91bGQgYmUgYSBudW1iZXIuIFRoZSBmaWVsZCB3aWxsIGJlIGFsd2F5cyBpbnZhbGlkLmApLCB0aGlzLnNldEZpZWxkSW52YWxpZChlLCBzKTtcbiAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoYSA9PSBudWxsID8gdm9pZCAwIDogYS5sZW5ndGgpICYmIGEubGVuZ3RoID4gcikge1xuICAgICAgICAgICAgdGhpcy5zZXRGaWVsZEludmFsaWQoZSwgcyk7XG4gICAgICAgICAgICBicmVha1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVha1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgZC5GaWxlczoge1xuICAgICAgICAgIGlmIChyID09PSB2b2lkIDApIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFZhbHVlIGZvciAke3MucnVsZX0gcnVsZSBmb3IgWyR7ZX1dIGZpZWxkIGlzIG5vdCBkZWZpbmVkLiBUaGlzIGZpZWxkIHdpbGwgYmUgYWx3YXlzIGludmFsaWQuYCksIHRoaXMuc2V0RmllbGRJbnZhbGlkKGUsIHMpO1xuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh0eXBlb2YgciAhPSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBWYWx1ZSBmb3IgJHtzLnJ1bGV9IHJ1bGUgZm9yIFske2V9XSBmaWVsZCBzaG91bGQgYmUgYW4gb2JqZWN0LiBUaGlzIGZpZWxkIHdpbGwgYmUgYWx3YXlzIGludmFsaWQuYCksIHRoaXMuc2V0RmllbGRJbnZhbGlkKGUsIHMpO1xuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IGwgPSByLmZpbGVzO1xuICAgICAgICAgIGlmICh0eXBlb2YgbCAhPSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBWYWx1ZSBmb3IgJHtzLnJ1bGV9IHJ1bGUgZm9yIFske2V9XSBmaWVsZCBzaG91bGQgYmUgYW4gb2JqZWN0IHdpdGggZmlsZXMgYXJyYXkuIFRoaXMgZmllbGQgd2lsbCBiZSBhbHdheXMgaW52YWxpZC5gKSwgdGhpcy5zZXRGaWVsZEludmFsaWQoZSwgcyk7XG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgbyA9IChjLCBoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBmID0gTnVtYmVyLmlzRmluaXRlKGgubWluU2l6ZSkgJiYgYy5zaXplIDwgaC5taW5TaXplLFxuICAgICAgICAgICAgICBtID0gTnVtYmVyLmlzRmluaXRlKGgubWF4U2l6ZSkgJiYgYy5zaXplID4gaC5tYXhTaXplLFxuICAgICAgICAgICAgICB2ID0gQXJyYXkuaXNBcnJheShoLm5hbWVzKSAmJiAhaC5uYW1lcy5pbmNsdWRlcyhjLm5hbWUpLFxuICAgICAgICAgICAgICBEID0gQXJyYXkuaXNBcnJheShoLmV4dGVuc2lvbnMpICYmICFoLmV4dGVuc2lvbnMuaW5jbHVkZXMoYy5uYW1lLnNwbGl0KFwiLlwiKVtjLm5hbWUuc3BsaXQoXCIuXCIpLmxlbmd0aCAtIDFdKSxcbiAgICAgICAgICAgICAgSCA9IEFycmF5LmlzQXJyYXkoaC50eXBlcykgJiYgIWgudHlwZXMuaW5jbHVkZXMoYy50eXBlKTtcbiAgICAgICAgICAgIHJldHVybiBmIHx8IG0gfHwgdiB8fCBEIHx8IEhcbiAgICAgICAgICB9O1xuICAgICAgICAgIGlmICh0eXBlb2YgYSA9PSBcIm9iamVjdFwiICYmIGEgIT09IG51bGwpXG4gICAgICAgICAgICBmb3IgKGxldCBjID0gMCwgaCA9IGEubGVuZ3RoOyBjIDwgaDsgKytjKSB7XG4gICAgICAgICAgICAgIGNvbnN0IGYgPSBhLml0ZW0oYyk7XG4gICAgICAgICAgICAgIGlmICghZikge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0RmllbGRJbnZhbGlkKGUsIHMpO1xuICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgaWYgKG8oZiwgbCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldEZpZWxkSW52YWxpZChlLCBzKTtcbiAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgfVxuICAgICAgICBkZWZhdWx0OiB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBzLnZhbGlkYXRvciAhPSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFZhbGlkYXRvciBmb3IgY3VzdG9tIHJ1bGUgZm9yIFske2V9XSBmaWVsZCBzaG91bGQgYmUgYSBmdW5jdGlvbi4gVGhpcyBmaWVsZCB3aWxsIGJlIGFsd2F5cyBpbnZhbGlkLmApLCB0aGlzLnNldEZpZWxkSW52YWxpZChlLCBzKTtcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBsID0gcy52YWxpZGF0b3IoYSwgdGhpcy5maWVsZHMpO1xuICAgICAgICAgIGlmICh0eXBlb2YgbCAhPSBcImJvb2xlYW5cIiAmJiB0eXBlb2YgbCAhPSBcImZ1bmN0aW9uXCIgJiYgY29uc29sZS5lcnJvcihgVmFsaWRhdG9yIHJldHVybiB2YWx1ZSBmb3IgWyR7ZX1dIGZpZWxkIHNob3VsZCBiZSBib29sZWFuIG9yIGZ1bmN0aW9uLiBJdCB3aWxsIGJlIGNhc3QgdG8gYm9vbGVhbi5gKSwgdHlwZW9mIGwgPT0gXCJmdW5jdGlvblwiKVxuICAgICAgICAgICAgaWYgKGkpIHRoaXMuZmllbGRzW2VdLmFzeW5jQ2hlY2tQZW5kaW5nID0gITA7XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy5maWVsZHNbZV0uYXN5bmNDaGVja1BlbmRpbmcgPSAhMTtcbiAgICAgICAgICAgICAgY29uc3QgbyA9IGwoKTtcbiAgICAgICAgICAgICAgaWYgKCFGKG8pKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgVmFsaWRhdG9yIGZ1bmN0aW9uIGZvciBjdXN0b20gcnVsZSBmb3IgWyR7ZX1dIGZpZWxkIHNob3VsZCByZXR1cm4gYSBQcm9taXNlLiBUaGlzIGZpZWxkIHdpbGwgYmUgYWx3YXlzIGludmFsaWQuYCksIHRoaXMuc2V0RmllbGRJbnZhbGlkKGUsIHMpO1xuICAgICAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHJldHVybiBvLnRoZW4oYyA9PiB7XG4gICAgICAgICAgICAgICAgYyB8fCB0aGlzLnNldEZpZWxkSW52YWxpZChlLCBzKVxuICAgICAgICAgICAgICB9KS5jYXRjaCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRGaWVsZEludmFsaWQoZSwgcylcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0gbCB8fCB0aGlzLnNldEZpZWxkSW52YWxpZChlLCBzKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHZhbGlkYXRlRmllbGQoZSwgdCwgcyA9ICExKSB7XG4gICAgICB2YXIgcjtcbiAgICAgIHQuaXNWYWxpZCA9ICEwO1xuICAgICAgY29uc3QgaSA9IFtdO1xuICAgICAgcmV0dXJuIFsuLi50LnJ1bGVzXS5yZXZlcnNlKCkuZm9yRWFjaChhID0+IHtcbiAgICAgICAgY29uc3QgbCA9IHRoaXMudmFsaWRhdGVGaWVsZFJ1bGUoZSwgdC5lbGVtLCBhLCBzKTtcbiAgICAgICAgRihsKSAmJiBpLnB1c2gobClcbiAgICAgIH0pLCB0LmlzVmFsaWQgJiYgdGhpcy5zZXRGaWVsZFZhbGlkKGUsIChyID0gdC5jb25maWcpID09IG51bGwgPyB2b2lkIDAgOiByLnN1Y2Nlc3NNZXNzYWdlKSwgUHJvbWlzZS5hbGxTZXR0bGVkKGkpXG4gICAgfVxuICAgIHZhbGlkYXRlR3JvdXAoZSwgdCkge1xuICAgICAgY29uc3QgcyA9IFtdO1xuICAgICAgcmV0dXJuIFsuLi50LnJ1bGVzXS5yZXZlcnNlKCkuZm9yRWFjaChpID0+IHtcbiAgICAgICAgY29uc3QgciA9IHRoaXMudmFsaWRhdGVHcm91cFJ1bGUoZSwgdC50eXBlLCB0LmVsZW1zLCBpKTtcbiAgICAgICAgRihyKSAmJiBzLnB1c2gocilcbiAgICAgIH0pLCBQcm9taXNlLmFsbFNldHRsZWQocylcbiAgICB9XG4gICAgZm9jdXNJbnZhbGlkRmllbGQoKSB7XG4gICAgICBmb3IgKGNvbnN0IGUgaW4gdGhpcy5maWVsZHMpIHtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMuZmllbGRzW2VdO1xuICAgICAgICBpZiAoIXQuaXNWYWxpZCkge1xuICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gdC5lbGVtLmZvY3VzKCksIDApO1xuICAgICAgICAgIGJyZWFrXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgYWZ0ZXJTdWJtaXRWYWxpZGF0aW9uKCkge1xuICAgICAgdGhpcy5yZW5kZXJFcnJvcnMoKSwgdGhpcy5nbG9iYWxDb25maWcuZm9jdXNJbnZhbGlkRmllbGQgJiYgdGhpcy5mb2N1c0ludmFsaWRGaWVsZCgpXG4gICAgfVxuICAgIHZhbGlkYXRlKCkge1xuICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGUgPT4ge1xuICAgICAgICBjb25zdCB0ID0gW107XG4gICAgICAgIE9iamVjdC5rZXlzKHRoaXMuZmllbGRzKS5mb3JFYWNoKHMgPT4ge1xuICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLmZpZWxkc1tzXSxcbiAgICAgICAgICAgIHIgPSB0aGlzLnZhbGlkYXRlRmllbGQocywgaSk7XG4gICAgICAgICAgRihyKSAmJiB0LnB1c2gocilcbiAgICAgICAgfSksIE9iamVjdC5rZXlzKHRoaXMuZ3JvdXBGaWVsZHMpLmZvckVhY2gocyA9PiB7XG4gICAgICAgICAgY29uc3QgaSA9IHRoaXMuZ3JvdXBGaWVsZHNbc10sXG4gICAgICAgICAgICByID0gdGhpcy52YWxpZGF0ZUdyb3VwKHMsIGkpO1xuICAgICAgICAgIEYocikgJiYgdC5wdXNoKHIpXG4gICAgICAgIH0pLCB0Lmxlbmd0aCA/IFByb21pc2UuYWxsU2V0dGxlZCh0KS50aGVuKCgpID0+IHtcbiAgICAgICAgICB0aGlzLmFmdGVyU3VibWl0VmFsaWRhdGlvbigpLCBlKCEwKVxuICAgICAgICB9KSA6ICh0aGlzLmFmdGVyU3VibWl0VmFsaWRhdGlvbigpLCBlKCExKSlcbiAgICAgIH0pXG4gICAgfVxuICAgIHNldEZvcm0oZSkge1xuICAgICAgdGhpcy5mb3JtID0gZSwgdGhpcy5mb3JtLnNldEF0dHJpYnV0ZShcIm5vdmFsaWRhdGVcIiwgXCJub3ZhbGlkYXRlXCIpLCB0aGlzLnJlbW92ZUxpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuZm9ybSwgdGhpcy5mb3JtU3VibWl0SGFuZGxlciksIHRoaXMuYWRkTGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5mb3JtLCB0aGlzLmZvcm1TdWJtaXRIYW5kbGVyKVxuICAgIH1cbiAgICBhZGRMaXN0ZW5lcihlLCB0LCBzKSB7XG4gICAgICB0LmFkZEV2ZW50TGlzdGVuZXIoZSwgcyksIHRoaXMuZXZlbnRMaXN0ZW5lcnMucHVzaCh7XG4gICAgICAgIHR5cGU6IGUsXG4gICAgICAgIGVsZW06IHQsXG4gICAgICAgIGZ1bmM6IHNcbiAgICAgIH0pXG4gICAgfVxuICAgIHJlbW92ZUxpc3RlbmVyKGUsIHQsIHMpIHtcbiAgICAgIHQucmVtb3ZlRXZlbnRMaXN0ZW5lcihlLCBzKSwgdGhpcy5ldmVudExpc3RlbmVycyA9IHRoaXMuZXZlbnRMaXN0ZW5lcnMuZmlsdGVyKGkgPT4gaS50eXBlICE9PSBlIHx8IGkuZWxlbSAhPT0gdClcbiAgICB9XG4gICAgYWRkRmllbGQoZSwgdCwgcykge1xuICAgICAgaWYgKHR5cGVvZiBlICE9IFwic3RyaW5nXCIpIHRocm93IEVycm9yKFwiRmllbGQgc2VsZWN0b3IgaXMgbm90IHZhbGlkLiBQbGVhc2Ugc3BlY2lmeSBhIHN0cmluZyBzZWxlY3Rvci5cIik7XG4gICAgICBjb25zdCBpID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlKTtcbiAgICAgIGlmICghaSkgdGhyb3cgRXJyb3IoYEZpZWxkIHdpdGggJHtlfSBzZWxlY3RvciBub3QgZm91bmQhIFBsZWFzZSBjaGVjayB0aGUgZmllbGQgc2VsZWN0b3IuYCk7XG4gICAgICBpZiAoIUFycmF5LmlzQXJyYXkodCkgfHwgIXQubGVuZ3RoKSB0aHJvdyBFcnJvcihgUnVsZXMgYXJndW1lbnQgZm9yIHRoZSBmaWVsZCBbJHtlfV0gc2hvdWxkIGJlIGFuIGFycmF5IGFuZCBzaG91bGQgY29udGFpbiBhdCBsZWFzdCAxIGVsZW1lbnQuYCk7XG4gICAgICByZXR1cm4gdC5mb3JFYWNoKHIgPT4ge1xuICAgICAgICBpZiAoIShcInJ1bGVcIiBpbiByIHx8IFwidmFsaWRhdG9yXCIgaW4gciB8fCBcInBsdWdpblwiIGluIHIpKSB0aHJvdyBFcnJvcihgUnVsZXMgYXJndW1lbnQgZm9yIHRoZSBmaWVsZCBbJHtlfV0gbXVzdCBjb250YWluIGF0IGxlYXN0IG9uZSBydWxlIG9yIHZhbGlkYXRvciBwcm9wZXJ0eS5gKTtcbiAgICAgICAgaWYgKCFyLnZhbGlkYXRvciAmJiAhci5wbHVnaW4gJiYgKCFyLnJ1bGUgfHwgIU9iamVjdC52YWx1ZXMoZCkuaW5jbHVkZXMoci5ydWxlKSkpIHRocm93IEVycm9yKGBSdWxlIHNob3VsZCBiZSBvbmUgb2YgdGhlc2UgdHlwZXM6ICR7T2JqZWN0LnZhbHVlcyhkKS5qb2luKFwiLCBcIil9LiBQcm92aWRlZCB2YWx1ZTogJHtyLnJ1bGV9YClcbiAgICAgIH0pLCB0aGlzLmZpZWxkc1tlXSA9IHtcbiAgICAgICAgZWxlbTogaSxcbiAgICAgICAgcnVsZXM6IHQsXG4gICAgICAgIGlzVmFsaWQ6IHZvaWQgMCxcbiAgICAgICAgY29uZmlnOiBzXG4gICAgICB9LCB0aGlzLnNldExpc3RlbmVycyhpKSwgdGhpcy5pc1N1Ym1pdHRlZCAmJiB0aGlzLnZhbGlkYXRlKCksIHRoaXNcbiAgICB9XG4gICAgcmVtb3ZlRmllbGQoZSkge1xuICAgICAgaWYgKHR5cGVvZiBlICE9IFwic3RyaW5nXCIpIHRocm93IEVycm9yKFwiRmllbGQgc2VsZWN0b3IgaXMgbm90IHZhbGlkLiBQbGVhc2Ugc3BlY2lmeSBhIHN0cmluZyBzZWxlY3Rvci5cIik7XG4gICAgICBpZiAoIXRoaXMuZmllbGRzW2VdKSByZXR1cm4gY29uc29sZS5lcnJvcihcIkZpZWxkIG5vdCBmb3VuZC4gQ2hlY2sgdGhlIGZpZWxkIHNlbGVjdG9yLlwiKSwgdGhpcztcbiAgICAgIGNvbnN0IHQgPSB0aGlzLmdldExpc3RlbmVyVHlwZSh0aGlzLmZpZWxkc1tlXS5lbGVtLnR5cGUpO1xuICAgICAgcmV0dXJuIHRoaXMucmVtb3ZlTGlzdGVuZXIodCwgdGhpcy5maWVsZHNbZV0uZWxlbSwgdGhpcy5oYW5kbGVyQ2hhbmdlKSwgdGhpcy5jbGVhckVycm9ycygpLCBkZWxldGUgdGhpcy5maWVsZHNbZV0sIHRoaXNcbiAgICB9XG4gICAgcmVtb3ZlR3JvdXAoZSkge1xuICAgICAgaWYgKHR5cGVvZiBlICE9IFwic3RyaW5nXCIpIHRocm93IEVycm9yKFwiR3JvdXAgc2VsZWN0b3IgaXMgbm90IHZhbGlkLiBQbGVhc2Ugc3BlY2lmeSBhIHN0cmluZyBzZWxlY3Rvci5cIik7XG4gICAgICByZXR1cm4gdGhpcy5ncm91cEZpZWxkc1tlXSA/ICh0aGlzLmdyb3VwRmllbGRzW2VdLmVsZW1zLmZvckVhY2godCA9PiB7XG4gICAgICAgIGNvbnN0IHMgPSB0aGlzLmdldExpc3RlbmVyVHlwZSh0LnR5cGUpO1xuICAgICAgICB0aGlzLnJlbW92ZUxpc3RlbmVyKHMsIHQsIHRoaXMuaGFuZGxlckNoYW5nZSlcbiAgICAgIH0pLCB0aGlzLmNsZWFyRXJyb3JzKCksIGRlbGV0ZSB0aGlzLmdyb3VwRmllbGRzW2VdLCB0aGlzKSA6IChjb25zb2xlLmVycm9yKFwiR3JvdXAgbm90IGZvdW5kLiBDaGVjayB0aGUgZ3JvdXAgc2VsZWN0b3IuXCIpLCB0aGlzKVxuICAgIH1cbiAgICBhZGRSZXF1aXJlZEdyb3VwKGUsIHQsIHMsIGkpIHtcbiAgICAgIGlmICh0eXBlb2YgZSAhPSBcInN0cmluZ1wiKSB0aHJvdyBFcnJvcihcIkdyb3VwIHNlbGVjdG9yIGlzIG5vdCB2YWxpZC4gUGxlYXNlIHNwZWNpZnkgYSBzdHJpbmcgc2VsZWN0b3IuXCIpO1xuICAgICAgY29uc3QgciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZSk7XG4gICAgICBpZiAoIXIpIHRocm93IEVycm9yKGBHcm91cCB3aXRoICR7ZX0gc2VsZWN0b3Igbm90IGZvdW5kISBQbGVhc2UgY2hlY2sgdGhlIGdyb3VwIHNlbGVjdG9yLmApO1xuICAgICAgY29uc3QgYSA9IHIucXVlcnlTZWxlY3RvckFsbChcImlucHV0XCIpLFxuICAgICAgICBsID0gQXJyYXkuZnJvbShhKS5ldmVyeShjID0+IGMudHlwZSA9PT0gXCJyYWRpb1wiKSxcbiAgICAgICAgbyA9IEFycmF5LmZyb20oYSkuZXZlcnkoYyA9PiBjLnR5cGUgPT09IFwiY2hlY2tib3hcIik7XG4gICAgICBpZiAoIWwgJiYgIW8pIHRocm93IEVycm9yKFwiR3JvdXAgc2hvdWxkIGNvbnRhaW4gZWl0aGVyIG9yIGNoZWNrYm94ZXMgb3IgcmFkaW8gYnV0dG9uc1wiKTtcbiAgICAgIHJldHVybiB0aGlzLmdyb3VwRmllbGRzW2VdID0ge1xuICAgICAgICBydWxlczogW3tcbiAgICAgICAgICBydWxlOiB5LlJlcXVpcmVkLFxuICAgICAgICAgIGVycm9yTWVzc2FnZTogdCxcbiAgICAgICAgICBzdWNjZXNzTWVzc2FnZTogaVxuICAgICAgICB9XSxcbiAgICAgICAgZ3JvdXBFbGVtOiByLFxuICAgICAgICBlbGVtczogQXJyYXkuZnJvbShhKSxcbiAgICAgICAgdHlwZTogbCA/IFwicmFkaW9cIiA6IFwiY2hlY2tib3hcIixcbiAgICAgICAgaXNEaXJ0eTogITEsXG4gICAgICAgIGlzVmFsaWQ6IHZvaWQgMCxcbiAgICAgICAgY29uZmlnOiBzXG4gICAgICB9LCBhLmZvckVhY2goYyA9PiB7XG4gICAgICAgIHRoaXMuc2V0TGlzdGVuZXJzKGMpXG4gICAgICB9KSwgdGhpc1xuICAgIH1cbiAgICBnZXRMaXN0ZW5lclR5cGUoZSkge1xuICAgICAgc3dpdGNoIChlKSB7XG4gICAgICAgIGNhc2UgXCJjaGVja2JveFwiOlxuICAgICAgICBjYXNlIFwic2VsZWN0LW9uZVwiOlxuICAgICAgICBjYXNlIFwiZmlsZVwiOlxuICAgICAgICBjYXNlIFwicmFkaW9cIjpcbiAgICAgICAgICByZXR1cm4gXCJjaGFuZ2VcIjtcbiAgICAgICAgY2FzZSBcImRhdGVcIjpcbiAgICAgICAgICByZXR1cm4gXCJpbnB1dFwiO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHJldHVybiBcImtleXVwXCJcbiAgICAgIH1cbiAgICB9XG4gICAgc2V0TGlzdGVuZXJzKGUpIHtcbiAgICAgIGNvbnN0IHQgPSB0aGlzLmdldExpc3RlbmVyVHlwZShlLnR5cGUpO1xuICAgICAgdGhpcy5yZW1vdmVMaXN0ZW5lcih0LCBlLCB0aGlzLmhhbmRsZXJDaGFuZ2UpLCB0aGlzLmFkZExpc3RlbmVyKHQsIGUsIHRoaXMuaGFuZGxlckNoYW5nZSlcbiAgICB9XG4gICAgY2xlYXJFcnJvcnMoKSB7XG4gICAgICB2YXIgZSwgdCwgcywgaSwgciwgYTtcbiAgICAgIHRoaXMuZXJyb3JMYWJlbHMuZm9yRWFjaChsID0+IGwucmVtb3ZlKCkpLCB0aGlzLnN1Y2Nlc3NMYWJlbHMuZm9yRWFjaChsID0+IGwucmVtb3ZlKCkpO1xuICAgICAgZm9yIChjb25zdCBsIGluIHRoaXMuZmllbGRzKSB7XG4gICAgICAgIGNvbnN0IG8gPSB0aGlzLmZpZWxkc1tsXSxcbiAgICAgICAgICBjID0gKChlID0gby5jb25maWcpID09IG51bGwgPyB2b2lkIDAgOiBlLmVycm9yRmllbGRTdHlsZSkgfHwgdGhpcy5nbG9iYWxDb25maWcuZXJyb3JGaWVsZFN0eWxlO1xuICAgICAgICBPYmplY3Qua2V5cyhjKS5mb3JFYWNoKGYgPT4ge1xuICAgICAgICAgIG8uZWxlbS5zdHlsZVtmXSA9IFwiXCJcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGggPSAoKHQgPSBvLmNvbmZpZykgPT0gbnVsbCA/IHZvaWQgMCA6IHQuc3VjY2Vzc0ZpZWxkU3R5bGUpIHx8IHRoaXMuZ2xvYmFsQ29uZmlnLnN1Y2Nlc3NGaWVsZFN0eWxlIHx8IHt9O1xuICAgICAgICBPYmplY3Qua2V5cyhoKS5mb3JFYWNoKGYgPT4ge1xuICAgICAgICAgIG8uZWxlbS5zdHlsZVtmXSA9IFwiXCJcbiAgICAgICAgfSksIG8uZWxlbS5jbGFzc0xpc3QucmVtb3ZlKCgocyA9IG8uY29uZmlnKSA9PSBudWxsID8gdm9pZCAwIDogcy5lcnJvckZpZWxkQ3NzQ2xhc3MpIHx8IHRoaXMuZ2xvYmFsQ29uZmlnLmVycm9yRmllbGRDc3NDbGFzcywgKChpID0gby5jb25maWcpID09IG51bGwgPyB2b2lkIDAgOiBpLnN1Y2Nlc3NGaWVsZENzc0NsYXNzKSB8fCB0aGlzLmdsb2JhbENvbmZpZy5zdWNjZXNzRmllbGRDc3NDbGFzcylcbiAgICAgIH1cbiAgICAgIGZvciAoY29uc3QgbCBpbiB0aGlzLmdyb3VwRmllbGRzKSB7XG4gICAgICAgIGNvbnN0IG8gPSB0aGlzLmdyb3VwRmllbGRzW2xdLFxuICAgICAgICAgIGMgPSAoKHIgPSBvLmNvbmZpZykgPT0gbnVsbCA/IHZvaWQgMCA6IHIuZXJyb3JGaWVsZFN0eWxlKSB8fCB0aGlzLmdsb2JhbENvbmZpZy5lcnJvckZpZWxkU3R5bGU7XG4gICAgICAgIE9iamVjdC5rZXlzKGMpLmZvckVhY2goZiA9PiB7XG4gICAgICAgICAgby5lbGVtcy5mb3JFYWNoKG0gPT4ge1xuICAgICAgICAgICAgdmFyIHY7XG4gICAgICAgICAgICBtLnN0eWxlW2ZdID0gXCJcIiwgbS5jbGFzc0xpc3QucmVtb3ZlKCgodiA9IG8uY29uZmlnKSA9PSBudWxsID8gdm9pZCAwIDogdi5lcnJvckZpZWxkQ3NzQ2xhc3MpIHx8IHRoaXMuZ2xvYmFsQ29uZmlnLmVycm9yRmllbGRDc3NDbGFzcylcbiAgICAgICAgICB9KVxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgaCA9ICgoYSA9IG8uY29uZmlnKSA9PSBudWxsID8gdm9pZCAwIDogYS5zdWNjZXNzRmllbGRTdHlsZSkgfHwgdGhpcy5nbG9iYWxDb25maWcuc3VjY2Vzc0ZpZWxkU3R5bGUgfHwge307XG4gICAgICAgIE9iamVjdC5rZXlzKGgpLmZvckVhY2goZiA9PiB7XG4gICAgICAgICAgby5lbGVtcy5mb3JFYWNoKG0gPT4ge1xuICAgICAgICAgICAgdmFyIHY7XG4gICAgICAgICAgICBtLnN0eWxlW2ZdID0gXCJcIiwgbS5jbGFzc0xpc3QucmVtb3ZlKCgodiA9IG8uY29uZmlnKSA9PSBudWxsID8gdm9pZCAwIDogdi5zdWNjZXNzRmllbGRDc3NDbGFzcykgfHwgdGhpcy5nbG9iYWxDb25maWcuc3VjY2Vzc0ZpZWxkQ3NzQ2xhc3MpXG4gICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICAgIHRoaXMudG9vbHRpcHMgPSBbXVxuICAgIH1cbiAgICBpc1Rvb2x0aXAoKSB7XG4gICAgICByZXR1cm4gISF0aGlzLmdsb2JhbENvbmZpZy50b29sdGlwXG4gICAgfVxuICAgIGxvY2tGb3JtKCkge1xuICAgICAgY29uc3QgZSA9IHRoaXMuZm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiaW5wdXQsIHRleHRhcmVhLCBidXR0b24sIHNlbGVjdFwiKTtcbiAgICAgIGZvciAobGV0IHQgPSAwLCBzID0gZS5sZW5ndGg7IHQgPCBzOyArK3QpIGVbdF0uc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJkaXNhYmxlZFwiKSwgZVt0XS5zdHlsZS5wb2ludGVyRXZlbnRzID0gXCJub25lXCIsIGVbdF0uc3R5bGUud2Via2l0RmlsdGVyID0gXCJncmF5c2NhbGUoMTAwJSlcIiwgZVt0XS5zdHlsZS5maWx0ZXIgPSBcImdyYXlzY2FsZSgxMDAlKVwiXG4gICAgfVxuICAgIHVubG9ja0Zvcm0oKSB7XG4gICAgICBjb25zdCBlID0gdGhpcy5mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCJpbnB1dCwgdGV4dGFyZWEsIGJ1dHRvbiwgc2VsZWN0XCIpO1xuICAgICAgZm9yIChsZXQgdCA9IDAsIHMgPSBlLmxlbmd0aDsgdCA8IHM7ICsrdCkgZVt0XS5yZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKSwgZVt0XS5zdHlsZS5wb2ludGVyRXZlbnRzID0gXCJcIiwgZVt0XS5zdHlsZS53ZWJraXRGaWx0ZXIgPSBcIlwiLCBlW3RdLnN0eWxlLmZpbHRlciA9IFwiXCJcbiAgICB9XG4gICAgcmVuZGVyVG9vbHRpcChlLCB0LCBzKSB7XG4gICAgICB2YXIgZjtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgdG9wOiBpLFxuICAgICAgICBsZWZ0OiByLFxuICAgICAgICB3aWR0aDogYSxcbiAgICAgICAgaGVpZ2h0OiBsXG4gICAgICB9ID0gZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSwgbyA9IHQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksIGMgPSBzIHx8ICgoZiA9IHRoaXMuZ2xvYmFsQ29uZmlnLnRvb2x0aXApID09IG51bGwgPyB2b2lkIDAgOiBmLnBvc2l0aW9uKTtcbiAgICAgIHN3aXRjaCAoYykge1xuICAgICAgICBjYXNlIFwibGVmdFwiOiB7XG4gICAgICAgICAgdC5zdHlsZS50b3AgPSBgJHtpK2wvMi1vLmhlaWdodC8yfXB4YCwgdC5zdHlsZS5sZWZ0ID0gYCR7ci1vLndpZHRoLUN9cHhgO1xuICAgICAgICAgIGJyZWFrXG4gICAgICAgIH1cbiAgICAgICAgY2FzZSBcInRvcFwiOiB7XG4gICAgICAgICAgdC5zdHlsZS50b3AgPSBgJHtpLW8uaGVpZ2h0LUN9cHhgLCB0LnN0eWxlLmxlZnQgPSBgJHtyK2EvMi1vLndpZHRoLzJ9cHhgO1xuICAgICAgICAgIGJyZWFrXG4gICAgICAgIH1cbiAgICAgICAgY2FzZSBcInJpZ2h0XCI6IHtcbiAgICAgICAgICB0LnN0eWxlLnRvcCA9IGAke2krbC8yLW8uaGVpZ2h0LzJ9cHhgLCB0LnN0eWxlLmxlZnQgPSBgJHtyK2ErQ31weGA7XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIFwiYm90dG9tXCI6IHtcbiAgICAgICAgICB0LnN0eWxlLnRvcCA9IGAke2krbCtDfXB4YCwgdC5zdHlsZS5sZWZ0ID0gYCR7cithLzItby53aWR0aC8yfXB4YDtcbiAgICAgICAgICBicmVha1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gdC5kYXRhc2V0LmRpcmVjdGlvbiA9IGMsIHtcbiAgICAgICAgcmVmcmVzaDogKCkgPT4ge1xuICAgICAgICAgIHRoaXMucmVuZGVyVG9vbHRpcChlLCB0LCBzKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGNyZWF0ZUVycm9yTGFiZWxFbGVtKGUsIHQsIHMpIHtcbiAgICAgIGNvbnN0IGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgaS5pbm5lckhUTUwgPSB0O1xuICAgICAgY29uc3QgciA9IHRoaXMuaXNUb29sdGlwKCkgPyBzID09IG51bGwgPyB2b2lkIDAgOiBzLmVycm9yTGFiZWxTdHlsZSA6IChzID09IG51bGwgPyB2b2lkIDAgOiBzLmVycm9yTGFiZWxTdHlsZSkgfHwgdGhpcy5nbG9iYWxDb25maWcuZXJyb3JMYWJlbFN0eWxlO1xuICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oaS5zdHlsZSwgciksIGkuY2xhc3NMaXN0LmFkZCgocyA9PSBudWxsID8gdm9pZCAwIDogcy5lcnJvckxhYmVsQ3NzQ2xhc3MpIHx8IHRoaXMuZ2xvYmFsQ29uZmlnLmVycm9yTGFiZWxDc3NDbGFzcywgXCJqdXN0LXZhbGlkYXRlLWVycm9yLWxhYmVsXCIpLCB0aGlzLmlzVG9vbHRpcCgpICYmIChpLmRhdGFzZXQudG9vbHRpcCA9IFwidHJ1ZVwiKSwgdGhpcy5nbG9iYWxDb25maWcudGVzdGluZ01vZGUgJiYgKGkuZGF0YXNldC50ZXN0SWQgPSBgZXJyb3ItbGFiZWwtJHtlfWApLCB0aGlzLmVycm9yTGFiZWxzLnB1c2goaSksIGlcbiAgICB9XG4gICAgY3JlYXRlU3VjY2Vzc0xhYmVsRWxlbShlLCB0LCBzKSB7XG4gICAgICBpZiAodCA9PT0gdm9pZCAwKSByZXR1cm4gbnVsbDtcbiAgICAgIGNvbnN0IGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgaS5pbm5lckhUTUwgPSB0O1xuICAgICAgY29uc3QgciA9IChzID09IG51bGwgPyB2b2lkIDAgOiBzLnN1Y2Nlc3NMYWJlbFN0eWxlKSB8fCB0aGlzLmdsb2JhbENvbmZpZy5zdWNjZXNzTGFiZWxTdHlsZTtcbiAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKGkuc3R5bGUsIHIpLCBpLmNsYXNzTGlzdC5hZGQoKHMgPT0gbnVsbCA/IHZvaWQgMCA6IHMuc3VjY2Vzc0xhYmVsQ3NzQ2xhc3MpIHx8IHRoaXMuZ2xvYmFsQ29uZmlnLnN1Y2Nlc3NMYWJlbENzc0NsYXNzLCBcImp1c3QtdmFsaWRhdGUtc3VjY2Vzcy1sYWJlbFwiKSwgdGhpcy5nbG9iYWxDb25maWcudGVzdGluZ01vZGUgJiYgKGkuZGF0YXNldC50ZXN0SWQgPSBgc3VjY2Vzcy1sYWJlbC0ke2V9YCksIHRoaXMuc3VjY2Vzc0xhYmVscy5wdXNoKGkpLCBpXG4gICAgfVxuICAgIHJlbmRlckZpZWxkTGFiZWwoZSwgdCkge1xuICAgICAgdmFyIHMsIGksIHIsIGEsIGwsIG8sIGM7XG4gICAgICBpZiAoZS50eXBlID09PSBcImNoZWNrYm94XCIgfHwgZS50eXBlID09PSBcInJhZGlvXCIpIHtcbiAgICAgICAgY29uc3QgaCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYGxhYmVsW2Zvcj1cIiR7ZS5nZXRBdHRyaWJ1dGUoXCJpZFwiKX1cIl1gKTtcbiAgICAgICAgKChpID0gKHMgPSBlLnBhcmVudEVsZW1lbnQpID09IG51bGwgPyB2b2lkIDAgOiBzLnRhZ05hbWUpID09IG51bGwgPyB2b2lkIDAgOiBpLnRvTG93ZXJDYXNlKCkpID09PSBcImxhYmVsXCIgPyAoYSA9IChyID0gZS5wYXJlbnRFbGVtZW50KSA9PSBudWxsID8gdm9pZCAwIDogci5wYXJlbnRFbGVtZW50KSA9PSBudWxsIHx8IGEuYXBwZW5kQ2hpbGQodCk6IGggPyAobCA9IGgucGFyZW50RWxlbWVudCkgPT0gbnVsbCB8fCBsLmFwcGVuZENoaWxkKHQpIDogKG8gPSBlLnBhcmVudEVsZW1lbnQpID09IG51bGwgfHwgby5hcHBlbmRDaGlsZCh0KVxuICAgICAgfSBlbHNlKGMgPSBlLnBhcmVudEVsZW1lbnQpID09IG51bGwgfHwgYy5hcHBlbmRDaGlsZCh0KVxuICAgIH1cbiAgICByZW5kZXJFcnJvcnMoKSB7XG4gICAgICB2YXIgZSwgdCwgcywgaSwgciwgYTtcbiAgICAgIGlmICghIXRoaXMuaXNTdWJtaXR0ZWQpIHtcbiAgICAgICAgdGhpcy5jbGVhckVycm9ycygpLCB0aGlzLmlzVmFsaWQgPSAhMDtcbiAgICAgICAgZm9yIChjb25zdCBsIGluIHRoaXMuZ3JvdXBGaWVsZHMpIHtcbiAgICAgICAgICBjb25zdCBvID0gdGhpcy5ncm91cEZpZWxkc1tsXTtcbiAgICAgICAgICBpZiAoby5pc1ZhbGlkKSB7XG4gICAgICAgICAgICBvLmVsZW1zLmZvckVhY2goZiA9PiB7XG4gICAgICAgICAgICAgIHZhciBtLCB2O1xuICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKGYuc3R5bGUsICgobSA9IG8uY29uZmlnKSA9PSBudWxsID8gdm9pZCAwIDogbS5zdWNjZXNzRmllbGRTdHlsZSkgfHwgdGhpcy5nbG9iYWxDb25maWcuc3VjY2Vzc0ZpZWxkU3R5bGUpLCBmLmNsYXNzTGlzdC5hZGQoKCh2ID0gby5jb25maWcpID09IG51bGwgPyB2b2lkIDAgOiB2LnN1Y2Nlc3NGaWVsZENzc0NsYXNzKSB8fCB0aGlzLmdsb2JhbENvbmZpZy5zdWNjZXNzRmllbGRDc3NDbGFzcylcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc3QgaCA9IHRoaXMuY3JlYXRlU3VjY2Vzc0xhYmVsRWxlbShsLCBvLnN1Y2Nlc3NNZXNzYWdlLCBvLmNvbmZpZyk7XG4gICAgICAgICAgICBoICYmIG8uZ3JvdXBFbGVtLmFwcGVuZENoaWxkKGgpO1xuICAgICAgICAgICAgY29udGludWVcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5pc1ZhbGlkID0gITEsIG8uZWxlbXMuZm9yRWFjaChoID0+IHtcbiAgICAgICAgICAgIHZhciBmLCBtO1xuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihoLnN0eWxlLCAoKGYgPSBvLmNvbmZpZykgPT0gbnVsbCA/IHZvaWQgMCA6IGYuZXJyb3JGaWVsZFN0eWxlKSB8fCB0aGlzLmdsb2JhbENvbmZpZy5lcnJvckZpZWxkU3R5bGUpLCBoLmNsYXNzTGlzdC5hZGQoKChtID0gby5jb25maWcpID09IG51bGwgPyB2b2lkIDAgOiBtLmVycm9yRmllbGRDc3NDbGFzcykgfHwgdGhpcy5nbG9iYWxDb25maWcuZXJyb3JGaWVsZENzc0NsYXNzKVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGNvbnN0IGMgPSB0aGlzLmNyZWF0ZUVycm9yTGFiZWxFbGVtKGwsIG8uZXJyb3JNZXNzYWdlLCBvLmNvbmZpZyk7XG4gICAgICAgICAgby5ncm91cEVsZW0uYXBwZW5kQ2hpbGQoYyksIHRoaXMuaXNUb29sdGlwKCkgJiYgdGhpcy50b29sdGlwcy5wdXNoKHRoaXMucmVuZGVyVG9vbHRpcChvLmdyb3VwRWxlbSwgYywgKHQgPSAoZSA9IG8uY29uZmlnKSA9PSBudWxsID8gdm9pZCAwIDogZS50b29sdGlwKSA9PSBudWxsID8gdm9pZCAwIDogdC5wb3NpdGlvbikpXG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCBsIGluIHRoaXMuZmllbGRzKSB7XG4gICAgICAgICAgY29uc3QgbyA9IHRoaXMuZmllbGRzW2xdO1xuICAgICAgICAgIGlmIChvLmlzVmFsaWQpIHtcbiAgICAgICAgICAgIGlmICghby5hc3luY0NoZWNrUGVuZGluZykge1xuICAgICAgICAgICAgICBjb25zdCBoID0gdGhpcy5jcmVhdGVTdWNjZXNzTGFiZWxFbGVtKGwsIG8uc3VjY2Vzc01lc3NhZ2UsIG8uY29uZmlnKTtcbiAgICAgICAgICAgICAgaCAmJiB0aGlzLnJlbmRlckZpZWxkTGFiZWwoby5lbGVtLCBoKSwgby5lbGVtLmNsYXNzTGlzdC5hZGQoKChzID0gby5jb25maWcpID09IG51bGwgPyB2b2lkIDAgOiBzLnN1Y2Nlc3NGaWVsZENzc0NsYXNzKSB8fCB0aGlzLmdsb2JhbENvbmZpZy5zdWNjZXNzRmllbGRDc3NDbGFzcylcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnRpbnVlXG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuaXNWYWxpZCA9ICExLCBvLmVsZW0uY2xhc3NMaXN0LmFkZCgoKGkgPSBvLmNvbmZpZykgPT0gbnVsbCA/IHZvaWQgMCA6IGkuZXJyb3JGaWVsZENzc0NsYXNzKSB8fCB0aGlzLmdsb2JhbENvbmZpZy5lcnJvckZpZWxkQ3NzQ2xhc3MpO1xuICAgICAgICAgIGNvbnN0IGMgPSB0aGlzLmNyZWF0ZUVycm9yTGFiZWxFbGVtKGwsIG8uZXJyb3JNZXNzYWdlLCBvLmNvbmZpZyk7XG4gICAgICAgICAgdGhpcy5yZW5kZXJGaWVsZExhYmVsKG8uZWxlbSwgYyksIHRoaXMuaXNUb29sdGlwKCkgJiYgdGhpcy50b29sdGlwcy5wdXNoKHRoaXMucmVuZGVyVG9vbHRpcChvLmVsZW0sIGMsIChhID0gKHIgPSBvLmNvbmZpZykgPT0gbnVsbCA/IHZvaWQgMCA6IHIudG9vbHRpcCkgPT0gbnVsbCA/IHZvaWQgMCA6IGEucG9zaXRpb24pKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGRlc3Ryb3koKSB7XG4gICAgICB0aGlzLmV2ZW50TGlzdGVuZXJzLmZvckVhY2goZSA9PiB7XG4gICAgICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIoZS50eXBlLCBlLmVsZW0sIGUuZnVuYylcbiAgICAgIH0pLCBPYmplY3Qua2V5cyh0aGlzLmN1c3RvbVN0eWxlVGFncykuZm9yRWFjaChlID0+IHtcbiAgICAgICAgdGhpcy5jdXN0b21TdHlsZVRhZ3NbZV0ucmVtb3ZlKClcbiAgICAgIH0pLCB0aGlzLmNsZWFyRXJyb3JzKCksIHRoaXMuZ2xvYmFsQ29uZmlnLmxvY2tGb3JtICYmIHRoaXMudW5sb2NrRm9ybSgpXG4gICAgfVxuICAgIHJlZnJlc2goKSB7XG4gICAgICB0aGlzLmRlc3Ryb3koKSwgdGhpcy5mb3JtID8gKHRoaXMuaW5pdGlhbGl6ZSh0aGlzLmZvcm0sIHRoaXMuZ2xvYmFsQ29uZmlnKSwgT2JqZWN0LmtleXModGhpcy5maWVsZHMpLmZvckVhY2goZSA9PiB7XG4gICAgICAgIHRoaXMuYWRkRmllbGQoZSwgWy4uLnRoaXMuZmllbGRzW2VdLnJ1bGVzXSwgdGhpcy5maWVsZHNbZV0uY29uZmlnKVxuICAgICAgfSkpIDogY29uc29sZS5lcnJvcihcIkNhbm5vdCBpbml0aWFsaXplIHRoZSBsaWJyYXJ5ISBGb3JtIGlzIG5vdCBkZWZpbmVkXCIpXG4gICAgfVxuICAgIHNldEN1cnJlbnRMb2NhbGUoZSkge1xuICAgICAgaWYgKHR5cGVvZiBlICE9IFwic3RyaW5nXCIgJiYgZSAhPT0gdm9pZCAwKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJDdXJyZW50IGxvY2FsZSBzaG91bGQgYmUgYSBzdHJpbmdcIik7XG4gICAgICAgIHJldHVyblxuICAgICAgfVxuICAgICAgdGhpcy5jdXJyZW50TG9jYWxlID0gZSwgdGhpcy5pc1N1Ym1pdHRlZCAmJiB0aGlzLnZhbGlkYXRlKClcbiAgICB9XG4gICAgb25TdWNjZXNzKGUpIHtcbiAgICAgIHJldHVybiB0aGlzLm9uU3VjY2Vzc0NhbGxiYWNrID0gZSwgdGhpc1xuICAgIH1cbiAgICBvbkZhaWwoZSkge1xuICAgICAgcmV0dXJuIHRoaXMub25GYWlsQ2FsbGJhY2sgPSBlLCB0aGlzXG4gICAgfVxuICB9XG4gIHJldHVybiBPXG59KTsiXX0=
